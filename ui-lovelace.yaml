background: var(--background-image)

title: Home - Main Server
views:
  ################################################################
  # MAIN PAGE
  ################################################################
  - title: Main
    icon: mdi:home
    cards:
      # ##################################
      # Left Block
      # ##################################a
      - type: vertical-stack
        cards:
          - type: custom:stack-in-card
            mode: vertical
            cards:
              - type: glance
                show_name: true
                show_state: true
                state_color: true
                columns: 5
                entities:
                  # - entity: sensor.d1mini_air_freshener_adc
                  #   name: V
                  # - entity: sensor.radiation_dose_per_hour
                  #   name: RA
                  # - entity: binary_sensor.rew_day
                  #   name: REW Day
                  - entity: sensor.pressure_weather_forecast
                    name: FCST
                  - entity: binary_sensor.tod_day
                    name: TOD
                  - entity: switch.system_dark_mode
                    name: Dark
                    tap_action:
                      action: toggle
                  - entity: switch.system_silent_mode
                    name: Zz
                    tap_action:
                      action: toggle
                  - entity: switch.system_guest_mode
                    name: Guest
                    tap_action:
                      action: toggle
              - type: glance
                show_name: true
                show_state: true
                state_color: true
                columns: 8
                entities:
                  - entity: sensor.zigbee_gateways_unavailable
                    name: Z GW Off
                  - entity: sensor.zigbee_devices_unavailable
                    name: Z Off
                  - entity: sensor.zigbee_devices_stats_unavailable
                    name: Z2
                  - entity: sensor.wifi_devices_unavailable
                    name: WF Off
                  - entity: sensor.temperature_outside
                    name: T Out
                  - entity: binary_sensor.bed_led_enable
                    name: Bed LED
                  - entity: switch.system_music_allowed
                    name: Night Alice
                  - entity: binary_sensor.treadmill
                    name: TMill
              - type: glance
                show_name: true
                show_state: true
                state_color: true
                columns: 4
                entities:
                  - person.dima
                  - person.sandra
                  - person.vova
                  - entity: person.sasha
                    name: Sasha
                    # tap_action:
                    #   action: call-service
                    #   service: input_boolean.toggle
                    #   service_data:
                    #     entity_id: input_boolean.sasha_tracker
                  - entity: person.natasha
                    name: Mam
                  - entity: person.vasya
                    name: Dad
                  - entity: person.elena
                    name: Lena
                  - entity: person.sergey
                    name: Serg
              - type: horizontal-stack
                cards:
                  - type: glance
                    columns: 7
                    entities:
                      - entity: sensor.pc_s_stats
                        name: "PC"
                      - entity: sensor.phone_s_stats
                        name: "ON"
                      - entity: sensor.phone_s_stats_during_lessons
                        name: "On L"
                      - entity: binary_sensor.pova_6_interactive
                        name: "Ph"
                      - entity: binary_sensor.school_phone_while_lesson #sensor.school_lesson_number
                        name: "–ê"
                      - entity: sensor.usd_rate
                        name: USD
                      - entity: sensor.eur_rate
                        name: EUR
                      # - entity: sensor.qiwi_usd_rate
                      #   name: QIWI USD

          - type: map
            aspect_ratio: "16x9"
            default_zoom: 16
            hours_to_show: 24
            entities:
              - person.dima
              - person.sandra
              - person.vova
              - person.sasha #device_tracker.note_9_sasha
          - type: custom:weather-chart-card
            #- type: custom:weather-card
            #- type: weather-forecast
            entity: weather.pirateweather
            forecast_type: daily
            units:
              pressure: mmHg
              speed: m/s

          - type: custom:stack-in-card
            mode: vertical
            cards:
              - type: glance
                columns: 5
                state_color: true
                entities:
                  - entity: sensor.ms01a_cpu_temp #sensor.processor_temperature
                    name: CPUT
                  - entity: sensor.ms01a_cpu_load
                    name: CPU
                  - entity: sensor.ms01a_memory_used
                    name: RAM
                  - entity: sensor.db_size
                    name: DB
                  - entity: sensor.influxdb_folder_size #sensor.influxdb_size #sensor.influxdb_total_size
                    name: Influx
              - type: horizontal-stack
                cards:
                  - type: conditional
                    conditions:
                      - condition: state
                        entity: binary_sensor.ippon_1500_status
                        state_not: "off"
                    card:
                      type: glance
                      columns: 1
                      state_color: true
                      entities:
                        - entity: sensor.ippon_1500_status_data
                          name: HB

                  - type: conditional
                    conditions:
                      - condition: state
                        entity: binary_sensor.ippon_1050_status
                        state_not: "off"
                    card:
                      type: glance
                      columns: 1
                      state_color: true
                      entities:
                        - entity: sensor.ippon_1050_status_data
                          name: St

                  # - type: conditional
                  #   conditions:
                  #     - entity: binary_sensor.cyber_650_status
                  #       state_not: "off"
                  #   card:
                  #     type: glance
                  #     columns: 1
                  #     state_color: true
                  #     entities:
                  #       - entity: sensor.cyber_650_status_data
                  #         name: K

                  # - type: conditional
                  #   conditions:
                  #     - entity: binary_sensor.ippon_650_status
                  #       state_not: "off"
                  #   card:
                  #     type: glance
                  #     columns: 1
                  #     state_color: true
                  #     entities:
                  #       - entity: sensor.ippon_650_status_data
                  #         name: S
          - type: custom:stack-in-card
            mode: vertical
            cards:
              - type: glance
                columns: 6
                state_color: true
                entities:
                  - entity: media_player.yandex_v
                    name: V
                  - entity: media_player.yandex_s
                    name: S
                  - entity: media_player.yandex_k
                    name: K
                  - entity: media_player.yandex_mb
                    name: MB
                  - entity: media_player.yandex_hb
                    name: HB
                  - entity: media_player.yandex_b
                    name: B

              - type: glance
                columns: 6
                state_color: true
                entities:
                  - entity: sensor.yandex_v_alice_state
                    name: V
                  - entity: sensor.yandex_s_alice_state
                    name: S
                  - entity: sensor.yandex_k_alice_state
                    name: K
                  - entity: sensor.yandex_mb_alice_state
                    name: MB
                  - entity: sensor.yandex_hb_alice_state
                    name: HB
                  - entity: sensor.yandex_b_alice_state
                    name: B

              - type: glance
                columns: 6
                state_color: true
                entities:
                  - entity: sensor.yandex_v_alice_volume
                    name: V
                  - entity: sensor.yandex_s_alice_volume
                    name: S
                  - entity: sensor.yandex_k_alice_volume
                    name: K
                  - entity: sensor.yandex_mb_alice_volume
                    name: MB
                  - entity: sensor.yandex_hb_alice_volume
                    name: HB
                  - entity: sensor.yandex_b_alice_volume
                    name: B

      # ##################################
      # Center Block
      # ##################################
      - type: vertical-stack
        cards:
          # - type: horizontal-stack
          #   cards:
          # - type: picture-entity
          #   camera_view: live
          #   aspect_ratio: "16x9"
          #   entity: camera.pinhole_stream_pinhole_stream #camera.door_hb
          #   show_name: false
          #   show_state: false
          # - type: picture-entity
          #   camera_view: live
          #   aspect_ratio: "16x9"
          #   entity: camera.g3_flex_entrance
          #   show_name: false
          #   show_state: false
          # - type: picture-entity
          #   camera_view: live
          #   aspect_ratio: "16x9"
          #   entity: camera.g3_flex_dixy
          #   show_name: false
          #   show_state: false
          # - type: picture-entity
          #   camera_view: live
          #   aspect_ratio: "16x9"
          #   entity: camera.g3_flex_window
          #   show_name: false
          #   show_state: false
          - type: horizontal-stack
            cards:
              - type: custom:webrtc-camera
                #entity: camera.pinhole_stream_pinhole_stream
                url: g4_doorbell
                ui: false
                muted: true
                intersection: 0.50
                background: false
                #mode: mse
                style: "video {aspect-ratio: 16/9; object-fit: fill;}"

              - type: custom:webrtc-camera
                url: g5_entrance
                ui: false
                muted: true
                intersection: 0.50
                background: false
                #mode: mse
              - type: custom:webrtc-camera
                url: g5_dixy
                ui: false
                muted: true
                intersection: 0.50
                background: false
                #mode: mse
              - type: custom:webrtc-camera
                url: g5_window
                ui: false
                muted: true
                intersection: 0.50
                background: false
                #mode: mse

          - type: glance
            show_name: true
            show_state: false
            state_color: true
            columns: 5
            entities:
              - entity: binary_sensor.0x00158d0001e53cda_motion
                name: MB
              - entity: binary_sensor.motion_s
                name: S
              - entity: binary_sensor.motion_v
                name: V
              - entity: binary_sensor.motion_b
                name: B
              - entity: binary_sensor.0x00158d0001e54280_motion
                name: T
              - entity: binary_sensor.motion_hb
                name: HB

              - entity: binary_sensor.motion_hs
                name: HS
              - entity: binary_sensor.motion_k
                name: K
              - entity: binary_sensor.motion_st
                name: St
              - entity: binary_sensor.g4_doorbell_motion #binary_sensor.pinhole_motion
                name: Doorbell #Pinhole
          - type: glance
            show_name: true
            show_state: false
            state_color: true
            columns: 5
            entities:
              - entity: binary_sensor.occupancy_mb
                name: MB
              - entity: binary_sensor.occupancy_s
                name: S
              - entity: binary_sensor.occupancy_v
                name: V
              - entity: binary_sensor.occupancy_b
                name: B
              - entity: binary_sensor.occupancy_t
                name: T
              - entity: binary_sensor.occupancy_hb
                name: HB
              - entity: binary_sensor.occupancy_hs
                name: HS
              - entity: binary_sensor.occupancy_k
                name: K
              - entity: binary_sensor.occupancy_st
                name: St

              # - entity: binary_sensor.wp_digma801_motion
              #   name: 801 Motion
          - type: glance
            show_name: true
            show_state: false
            state_color: true
            columns: 6
            entities:
              - entity: binary_sensor.wasp_mb
                name: MB
              - entity: binary_sensor.wasp_s
                name: S
              - entity: binary_sensor.wasp_v
                name: V
              - entity: binary_sensor.wasp_b
                name: B
              - entity: binary_sensor.wasp_t
                name: T
          # - type: glance
          #   show_name: true
          #   show_state: false
          #   state_color: true
          #   columns: 6
          #   entities:
          #     - entity: binary_sensor.yandex_voice_mb
          #       name: MB
          #     - entity: binary_sensor.yandex_voice_s
          #       name: S
          #     - entity: binary_sensor.yandex_voice_v
          #       name: V
          #     - entity: binary_sensor.yandex_voice_b
          #       name: B
          #     - entity: binary_sensor.yandex_voice_hb
          #       name: HB
          #     - entity: binary_sensor.yandex_voice_k
          #       name: K
          - type: glance
            show_name: true
            show_state: false
            state_color: true
            columns: 6
            entities:
              - entity: binary_sensor.presence_mb
                name: MB
              - entity: binary_sensor.presence_s
                name: S
              - entity: binary_sensor.presence_v
                name: V

              - entity: binary_sensor.presence_b
                name: B
              - entity: binary_sensor.presence_t
                name: T
              - entity: binary_sensor.presence_k #binary_sensor.dced838db04e_occupancy
                name: K

          - type: horizontal-stack
            cards:
              - type: glance
                show_name: true
                show_state: true
                state_color: true
                columns: 5
                entities:
                  - entity: binary_sensor.0x00158d00023297e7_moisture
                    name: K
                  - entity: binary_sensor.54ef44c335f4_water_leak
                    name: 2K
                  - entity: binary_sensor.0x00158d0002373a67_moisture
                    name: B
                  - entity: binary_sensor.0x00158d0002349f5b_moisture
                    name: W
                  - entity: binary_sensor.0x00158d00023684c2_moisture
                    name: T
              - type: glance
                show_name: true
                show_state: true
                state_color: true
                entities:
                  - entity: binary_sensor.fridge_hb
                    name: ""
                  - entity: binary_sensor.0x00158d000253722b_contact
                    name: Frdg
                  - entity: sensor.ble_temperature_ble_fridge #sensor.0x00158d0002461e5b_temperature
                    name: ""
                  - entity: binary_sensor.0x00158d000252acba_contact
                    name: Friz
                  - entity: sensor.ble_temperature_ble_freezer #sensor.0x00158d000237167c_temperature
                    name: ""

          - type: horizontal-stack
            cards:
              - type: glance
                columns: 7
                show_state: false #true
                state_color: true
                entities:
                  # - entity: input_boolean.bathroom_occupancy #binary_sensor.someone_showering
                  #   name: B
                  #   tap_action:
                  #     action: toggle
                  - entity: binary_sensor.presence_b
                    name: B
                  - entity: binary_sensor.presence_t
                    name: T
                  # - entity: binary_sensor.0x00158d000232ddd6_contact
                  #   name: Seat
                  - entity: fan.sonoff_pow_r2_1_bottom_fan
                    name: BFan B
                    tap_action:
                      action: toggle
                  - entity: fan.esp32_node_b_fan_b
                    name: Fan B
                    tap_action:
                      action: toggle
                  - entity: fan.esp32_node_b_fan_t
                    name: Fan T
                    tap_action:
                      action: toggle
                  - entity: button.esp32_node_b_open_valve #switch.esp32_node_b_relay_2
                    name: W.ON
                    tap_action:
                      action: toggle
                  - entity: button.esp32_node_b_close_valve #switch.esp32_node_b_relay_1
                    name: W.OFF
                    tap_action:
                      action: toggle
          - type: glance
            columns: 6
            show_state: false #true
            state_color: true
            entities:
              - entity: select.breather_v_auto_mode
                name: Auto Br V
                tap_action:
                  action: perform_action
                  perform_action: input_select.select_next
                  data:
                    entity_id: input_select.breather_v_auto_mode
              - entity: input_boolean.auto_fan_t
                name: Auto Fan T
                tap_action:
                  action: toggle
              - entity: switch.esp32_node_b_fan_b_force_mode
                name: Force Fan B
                tap_action:
                  action: toggle
              - entity: input_boolean.hot_water
                name: Hot Water
                tap_action:
                  action: toggle
              - entity: input_boolean.cold_water
                name: Cold Water
                tap_action:
                  action: toggle
              - entity: input_boolean.central_heating
                name: Heating
                tap_action:
                  action: toggle

          - type: glance
            show_state: true
            columns: 4
            state_color: true
            entities:
              - entity: fan.purifier2s
                name: Puri
                tap_action:
                  action: toggle
              - entity: fan.breather_v
                name: Breather V
                tap_action:
                  action: toggle
              - entity: fan.breather_s
                name: Breather S
                tap_action:
                  action: toggle
              - entity: fan.breather_mb
                name: Breather MB
                tap_action:
                  action: toggle

          # - type: horizontal-stack
          #   cards:
          #     - type: glance
          #       state_color: true
          #       entities:
          #         - entity: fan.purifier2s
          #           name: Puri
          #           tap_action:
          #             action: toggle
          #         - entity: sensor.purifier_mode
          #           name: Speed
          #           tap_action:
          #             action: call-service
          #             service: script.cycle_purifier_mode
          #         - entity: sensor.purifier2s_pm2_5
          #           name: PM2.5
          - type: custom:stack-in-card
            mode: vertical
            cards:
              - type: glance
                columns: 7
                state_color: true
                entities:
                  - entity: sensor.0x00158d0002464ec0_temperature
                    name: HB
                  - entity: sensor.0x00158d0001e586af_temperature
                    name: K
                  - entity: sensor.0x00158d000222c746_temperature
                    name: MB
                  - entity: sensor.0x00158d0001e6d85a_temperature
                    name: S
                  - entity: sensor.0x00158d0001e58714_temperature
                    name: V
                  - entity: sensor.0x00158d00020d7c3a_temperature
                    name: B
                  - entity: sensor.0x00158d0001e58754_temperature
                    name: T
              - type: glance
                columns: 7
                show_name: false
                show_state: true
                state_color: true
                entities:
                  - entity: sensor.0x00158d0002464ec0_humidity
                    name: HB
                  - entity: sensor.0x00158d0001e586af_humidity
                    name: K
                  - entity: sensor.0x00158d000222c746_humidity
                    name: MB
                  - entity: sensor.0x00158d0001e6d85a_humidity
                    name: S
                  - entity: sensor.0x00158d0001e58714_humidity
                    name: V
                  - entity: sensor.0x00158d00020d7c3a_humidity
                    name: B
                  - entity: sensor.0x00158d0001e58754_humidity
                    name: T
          - type: glance
            columns: 6
            state_color: true
            entities:
              - entity: sensor.humidity_average
                name: avg(H)
              - entity: sensor.abs_humidity_h
                name: abs(H)
              - entity: sensor.abs_humidity_b
                name: abs(B)
              - entity: sensor.dewpoint_b
                name: Dew B
              - entity: sensor.dewpoint_t
                name: Dew T
              - entity: sensor.esp32_node_b_cold_pipe
                name: cPipe
          - type: horizontal-stack
            cards:
              - type: glance
                columns: 5
                entities:
                  - entity: binary_sensor.esp8266_hood_k_stove_state
                    name: Stove
                  - entity: sensor.esp8266_hood_k_tcouple
                    name: T
                  - entity: binary_sensor.esp8266_oven_temp_k_oven_state
                    name: Oven
                  - entity: sensor.esp8266_oven_temp_k_temperature
                    name: T
                  - entity: input_select.oven_target_temperature
                    name: Target
          - type: glance
            columns: 7
            state_color: true
            entities:
              - entity: binary_sensor.a4c138833042_contact
                name: Door
              - entity: input_boolean.washer_door_issue
                name: Issue
              - entity: input_select.washer_state
                name: State
              - entity: counter.washing_machine_runs
                name: Runs
              - entity: input_number.washer_b_run_time
                name: RunTime
              - entity: input_number.washing_gel_usage
                name: Gel
              - entity: script.washing_machine_stats_reset
                name: Runs Reset
                tap_action:
                  action: perform-action
                  perform_action: script.washing_machine_stats_reset
          - type: glance
            columns: 4
            state_color: true
            entities:
              - entity: sensor.0x04cf8cdf3c772824_illuminance
                name: inV
              - entity: sensor.0x04cf8cdf3c77271d_illuminance
                name: oS
              - entity: sensor.0x04cf8cdf3c78d26e_illuminance
                name: oMB
              - entity: sensor.0x04cf8cdf3c7754a8_illuminance
                name: oK

      # ##################################
      # Right Block
      # ##################################
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            cards:
              - type: glance
                columns: 7
                state_color: true
                entities:
                  - entity: binary_sensor.sonoff_mini_1_switch #binary_sensor.doorbell
                    name: Doorbell
                    icon: mdi:doorbell
                  - entity: binary_sensor.esp32_domofon_incomingcall
                    name: Intercom
                    icon: mdi:phone-log
                  - entity: script.domofon_open_door
                    name: Open
                    icon: mdi:lock-open-outline
                    tap_action:
                      action: perform-action
                      perform_action: script.domofon_open_door
                  - entity: switch.esp32_domofon_mute #input_boolean.domofon_mute
                    name: Mute
                    tap_action:
                      action: toggle
                  - entity: switch.esp32_domofon_auto_open_once
                    name: AOpen 1
                    tap_action:
                      action: toggle
                  - entity: switch.esp32_domofon_auto_open
                    name: AOpen
                    tap_action:
                      action: toggle
                  - entity: switch.esp32_domofon_reject
                    name: Reject
                    tap_action:
                      action: toggle
          - type: horizontal-stack
            cards:
              - type: glance
                state_color: true
                entities:
                  - entity: binary_sensor.0x00158d0003262acc_contact
                    name: 220V State
              - type: glance
                state_color: true
                entities:
                  - entity: switch.kill_switch
                    tap_action:
                      action: toggle
              # - type: glance
              #   entities:
              #     - entity: script.go2rtc_restart
              #       name: go2rtc
              #       double_tap_action:
              #         action: call-service
              #         service: script.go2rtc_restart
              - type: glance
                state_color: true
                entities:
                  - entity: input_number.tv_delay
                    name: Time
                  - entity: timer.tv_delay_off
                    name: Start
                    tap_action:
                      action: perform-action
                      perform_action: script.tv_delay

          - type: glance
            #title: Lights
            show_name: true
            show_state: false
            columns: 6
            state_color: true
            entities:
              - entity: light.esp32_strip_1s_wadrobe_hb_rgb
                name: HB
                tap_action:
                  action: toggle
              - entity: light.esp32_strip_1s_entrance_hb_rgb
                name: W HB
                tap_action:
                  action: toggle
              - entity: light.0x00158d000223921b_channel_1
                name: Entrance
                tap_action:
                  action: toggle
                icon: mdi:ceiling-light
              - entity: light.0x00158d000253f04a_channel_2
                name: Fridge
                icon: mdi:ceiling-light
                tap_action:
                  action: toggle
              # - entity: light.bedside
              #   name: Lava HB
              #   icon: mdi:lava-lamp
              #   tap_action:
              #     action: toggle

              - entity: light.square_led_v
                name: Main V
                icon: mdi:card
                tap_action:
                  action: toggle
                double_tap_action:
                  action: perform-action
                  perform_action: light.turn_on
                  data:
                    entity_id: light.square_led_v
                    brightness: 230
                    kelvin: 5000
              - entity: light.square_led_v_nightlight
                name: Night V
                icon: mdi:card
                tap_action:
                  action: toggle
              - entity: light.0x54ef441000d4e7fd_light
                name: Desk V
                icon: mdi:desk-lamp
                tap_action:
                  action: toggle

              - entity: light.d1mini_bed_leds_strip_dima
                name: Bed D
                icon: mdi:led-strip-variant
                tap_action:
                  action: toggle
              - entity: light.d1mini_bed_leds_strip_sandra
                name: Bed S
                icon: mdi:led-strip-variant
                tap_action:
                  action: toggle

              - entity: light.round_led_mb
                name: Main MB
                icon: mdi:circle
                tap_action:
                  action: toggle
                double_tap_action:
                  action: perform-action
                  perform_action: light.turn_on
                  data:
                    entity_id: light.round_led_mb
                    brightness: 230
                    kelvin: 5000
              - entity: light.esp32_strip_1s_bookshelf_mb_rgb
                name: Str MB
                tap_action:
                  action: toggle
              - entity: light.esp32_strip_1s_wadrobe_mb_rgb
                name: Str2 MB
                tap_action:
                  action: toggle
              - entity: light.0x54ef441000c88fa8_light
                name: White MB
                icon: mdi:lamp
                tap_action:
                  action: toggle
                double_tap_action:
                  action: perform-action
                  perform_action: light.turn_on
                  data:
                    entity_id: light.0x54ef441000c88fa8_light
                    brightness: 230
                    kelvin: 5000

              - entity: light.square_led_s
                name: Main S
                tap_action:
                  action: toggle
                double_tap_action:
                  action: perform-action
                  perform_action: light.turn_on
                  data:
                    entity_id: light.square_led_s
                    brightness: 230
                    kelvin: 5000
              - entity: light.esp32_node_s_led
                name: Str S
                icon: mdi:alarm-light-outline
                tap_action:
                  action: toggle
              - entity: light.0x54ef441000d54c6c_light
                name: White S
                icon: mdi:lamp
                tap_action:
                  action: toggle
              - entity: light.0x54ef4410000ea59b_light
                name: Color S
                icon: mdi:desk-lamp
                tap_action:
                  action: toggle
                double_tap_action:
                  action: perform-action
                  perform_action: light.turn_on
                  data:
                    entity_id: light.0x54ef4410000ea59b_light
                    brightness: 230
                    kelvin: 5000
              - entity: light.light_bar_s
                name: Bar S
                icon: mdi:television-ambient-light
                tap_action:
                  action: toggle
              # - entity:  light.s26_socket_1_night_s
              #   name: Night S
              #   icon: mdi:candle
              #   tap_action:
              #     action: toggle

              - entity: light.round_led_hs
                name: Main HS
                tap_action:
                  action: toggle
              - entity: light.mono_strip_1_light
                name: Night HS
                tap_action:
                  action: toggle

              - entity: light.0x00158d0002a36433_channel_2
                name: Bath
                tap_action:
                  action: toggle
              - entity: light.mirror_light_b
                name: Mirror
                tap_action:
                  action: toggle

              - entity: light.0x00158d0002a36f7f_channel_1
                name: Main T
                tap_action:
                  action: toggle
              - entity: light.esp32_node_b_light
                name: Night T
                tap_action:
                  action: toggle

              - entity: light.round_led_k
                name: Main K
                tap_action:
                  action: perform-action
                  perform_action: automation.trigger
                  data:
                    entity_id: automation.kitchen_main_lamp_on
                double_tap_action:
                  action: perform-action
                  perform_action: light.turn_on
                  data:
                    entity_id: light.round_led_k
                    brightness: 230
                    kelvin: 5000
              - entity: light.esp32_node_k_light
                name: Night K
                icon: mdi:candle
                tap_action:
                  action: toggle
              - entity: light.d1mini_light_l_led
                name: L
                tap_action:
                  action: toggle
              - entity: light.sonoff_mini_4_led
                name: R
                tap_action:
                  action: toggle
              - entity: light.esp8266_hood_k_main
                name: Hood
                tap_action:
                  action: toggle

              - entity: light.0x54ef441000680083_channel_2
                name: Main St
                tap_action:
                  action: toggle
              - entity: light.round_led_st
                name: Night St
                tap_action:
                  action: toggle
              # - entity: light.0x00158d0002d3f7c9_light #light.led_color_st
              #   name: Bulb St
              #   tap_action:
              #     action: toggle

          - type: glance
            show_state: false
            columns: 6
            state_color: true
            entities:
              - entity: fan.esp8266_hood_k_fan #switch.esp32_node_k_fan1
                name: Hood
                tap_action:
                  action: toggle

              - entity: binary_sensor.washer_b
                name: Washer
              - entity: binary_sensor.kettle_k
                name: Kettle
              - entity: binary_sensor.microwave_k
                name: MW

              - entity: media_player.tv_k
                name: Samsung
                tap_action:
                  action: toggle
                  # service: switch.turn_on
                  # service_data:
                  #   entity_id: switch.digma_ir_k_tv_pwr

              # - entity: binary_sensor.mi_stick_k
              #   name: Stick
              #   tap_action:
              #     action: none

              - entity: media_player.tv_v
                name: Sony
                tap_action:
                  action: toggle #call-service
                  # service: switch.turn_on
                  # service_data:
                  #   entity_id: switch.digma_ir_v_tv_pwr

              # - entity: binary_sensor.mi_box_v #device_tracker.mi_box_v
              #   name: Box
              #   tap_action:
              #     action: none
          - type: glance
            show_name: true
            show_state: false
            state_color: true
            columns: 6
            entities:
              - entity: switch.0x00158d000230fc52_outlet
                name: Fridge
                icon: mdi:power-socket-au
                tap_action:
                  action: none
                  confirmation:
                    text: Are you sure you want to toggle?
              - entity: switch.0x00158d00024517fe_outlet
                name: Entr
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d0001f2630e_outlet
                name: Wadr L
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d00023e5812_outlet
                name: Wadr R
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d0001f26071_outlet
                name: Door HB
                icon: mdi:power-socket
                tap_action:
                  action: toggle
              - entity: switch.0x00158d000392623d_plug
                name: Heater HB
                tap_action:
                  action: toggle

              - entity: switch.0x00158d000249b26b_outlet
                name: Main HS
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d0002924790_plug
                name: Util HS
                icon: mdi:power-socket

              - entity: switch.0x00158d0002451850_outlet #switch.wall_plug_158d0002451850
                name: PC K
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d0002476ed1_outlet
                name: TV K
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d000249b25b_outlet
                name: Oven K
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d0001e85086_plug
                name: TV Plug K
                icon: mdi:power-socket
                tap_action:
                  action: toggle
              # - entity: switch.0x00158d000232481a_switch #switch.plug_158d000232481a
              #   name: Air K
              #   icon: mdi:power-socket
              #   tap_action:
              #     action: toggle

              - entity: switch.0x00158d0002467773_outlet
                name: PC MB
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d000224e3e4_outlet
                name: Entr MB
                tap_action:
                  action: toggle
              - entity: switch.0x00158d000322e30c_plug
                name: Wadr MB
                icon: mdi:power-socket
                tap_action:
                  action: toggle

              - entity: switch.0x00158d000246776f_outlet
                name: Entr V
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d000322e1d9_plug
                name: Window V
                tap_action:
                  action: toggle
              - entity: switch.0x00158d0002395dc9_outlet
                name: TV V
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d000290a093_plug
                name: TV Plug V
                icon: mdi:power-socket
                tap_action:
                  action: toggle

              - entity: switch.0x00158d000239097a_outlet
                name: PC S
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle
              - entity: switch.0x00158d0002395d58_outlet
                name: Window S
                icon: mdi:power-socket-au
                tap_action:
                  action: toggle

              - entity: switch.sonoff_pow_r2_1_relay #switch.0x00158d0002c3d86e_plug #switch.plug_158d0002c3d86e
                name: Washer
                tap_action:
                  action: toggle
              - entity: switch.0x00158d00028c9875_plug
                name: Kettle
                tap_action:
                  action: toggle
              - entity: switch.0x00158d00028a54e4_plug
                name: Microwave
                tap_action:
                  action: toggle
              # - entity: switch.sonoff_pow_r2_2_relay
              #   name: Heater T
              #   tap_action:
              #     action: toggle
          - type: horizontal-stack
            cards:
              - type: thermostat
                entity: climate.sonoff_pow_r2_2_wall_heater
                name: Wall Heater

          - type: glance
            columns: 6
            entities:
              - entity: sensor.sonoff_pow_r2_2_temperature
                name: T
              - entity: sensor.sonoff_pow_r2_2_humidity
                name: H
              - entity: sensor.sonoff_pow_r2_2_pressure
                name: Pr
              - entity: sensor.sonoff_pow_r2_2_voltage
                name: V
              - entity: sensor.sonoff_pow_r2_2_current
                name: A
              - entity: sensor.sonoff_pow_r2_2_power
                name: P
              # - entity: sensor.sonoff_pow_r2_2_energy_daily
              #   name: Daily

          # - type: glance
          #   show_name: true
          #   show_state: false
          #   state_color: true
          #   #columns: 6
          #   entities:
          # - entity: switch.gateway_plug_entrance_hb
          #   name: HBe
          #   tap_action:
          #     action: toggle
          #   icon: mdi:power
          # - entity: switch.gateway_plug_hb
          #   name: HB
          #   tap_action:
          #     action: toggle
          #   icon: mdi:power
          # - entity: switch.gateway_plug_hs
          #   name: HS
          #   tap_action:
          #     action: toggle
          #   icon: mdi:power
          # - entity: switch.gateway_plug_k
          #   name: K
          #   tap_action:
          #     action: toggle
          #   icon: mdi:power
          # - entity: switch.gateway_plug_mb
          #   name: MB
          #   tap_action:
          #     action: toggle
          #   icon: mdi:power
          # - entity: switch.gateway_plug_s
          #   name: S
          #   tap_action:
          #     action: toggle
          #   icon: mdi:power
          # - entity: switch.gateway_plug_v
          #   name: V
          #   tap_action:
          #     action: toggle
          #   icon: mdi:power
          # - entity: light.gateway_light_04cf8c978f0c
          #   name: HBe
          #   tap_action:
          #     action: toggle
          # - entity: light.gateway_light_7811dcb8cb4b
          #   name: HB
          #   tap_action:
          #     action: toggle
          # - entity: light.gateway_light_7c49eb195e21
          #   name: HS
          #   tap_action:
          #     action: toggle
          # - entity: light.gateway_light_04cf8c97808b
          #   name: K
          #   tap_action:
          #     action: toggle
          # - entity: light.gateway_light_7c49ebb1b5e1
          #   name: MB
          #   tap_action:
          #     action: toggle
          # - entity: light.gateway_light_7811dcb8d612
          #   name: S
          #   tap_action:
          #     action: toggle
          # - entity: light.gateway_light_7c49ebb19080
          #   name: V
          #   tap_action:
          #     action: toggle

        #OL - –ò–ë–ü —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç —Å–µ—Ç–∏,
        #OB - –ò–ë–ü —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç –±–∞—Ç–∞—Ä–µ–∏,
        #LB - –±–∞—Ç–∞—Ä–µ—è —Ä–∞–∑—Ä—è–∂–µ–Ω–∞,
        #RB - –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –∑–∞–º–µ–Ω–∞ –±–∞—Ç–∞—Ä–µ–∏,
        #CHRG - –±–∞—Ç–∞—Ä–µ—è –∑–∞—Ä—è–∂–∞–µ—Ç—Å—è,
        #DISCHRG - –±–∞—Ç–∞—Ä–µ—è —Ä–∞–∑—Ä—è–∂–∞–µ—Ç—Å—è,
        #BYPASS - –ò–ë–ü —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ –ø–∏—Ç–∞–Ω–∏—è –æ—Ç —Å–µ—Ç–∏ –≤ –æ–±—Ö–æ–¥ –±–∞—Ç–∞—Ä–µ–∏,
        #OVER - –ò–ë–ü –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω,
        #TRIM - –ò–ë–ü –æ—Ç—Ä–µ–∑–∞–µ—Ç –ø–æ–≤—ã—à–µ–Ω–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ —Å–µ—Ç–∏,
        #BOOST - –ò–ë–ü —É—Å–∏–ª–∏–≤–∞–µ—Ç –ø–æ–Ω–∏–∂–µ–Ω–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ —Å–µ—Ç–∏,

  ################################################################
  # SECURITY PAGE
  ################################################################
  - title: Security
    icon: mdi:shield
    cards:
      - type: vertical-stack
        cards:
          - type: glance
            state_color: true
            entities:
              - entity: switch.system_security_mode
                name: Security
                tap_action:
                  action: toggle
              - entity: binary_sensor.family_home
                name: Family
              # - entity: binary_sensor.family_home_extended
              #   name: Extended
              - entity: sensor.people_home
                name: At Home
              - entity: counter.main_door_hb
                name: In\Out
          - type: glance
            entities:
              - input_select.dima_status_dropdown
              - input_select.sandra_status_dropdown
              - input_select.vova_status_dropdown
              - input_select.sasha_status_dropdown
          - type: glance
            state_color: true
            entities:
              - entity: sensor.home_dima_distance
                name: Dima
              - entity: sensor.home_2_sandra_distance
                name: Sandra
              - entity: sensor.home_3_vova_distance
                name: Vova
              - entity: sensor.home_4_sasha_distance
                name: Sasha

          - type: entities
            show_header_toggle: false
            state_color: true
            entities:
              - binary_sensor.motion_1h
              - binary_sensor.someone_home_1h
              - type: divider
              - entity: binary_sensor.motion
                secondary_info: last-changed
              - entity: sensor.last_motion
                secondary_info: last-changed
              - type: divider
              # - entity: binary_sensor.motion_unifi
              #   secondary_info: last-changed
              # - type: divider
              - entity: binary_sensor.doors
                secondary_info: last-changed
              - entity: sensor.door_last_change
                secondary_info: last-changed
              - type: divider
              - entity: binary_sensor.windows
                secondary_info: last-changed
              - entity: sensor.window_last_change
                secondary_info: last-changed

          - type: entities
            show_header_toggle: false
            state_color: true
            entities:
              - entity: binary_sensor.0x00158d00024bcf85_gas
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d0002c92f31_smoke
                secondary_info: last-changed

      - type: vertical-stack
        cards:
          - type: custom:stack-in-card
            mode: vertical
            cards:
              - type: horizontal-stack
                cards:
                  - type: glance
                    show_header_toggle: false
                    state_color: true
                    entities:
                      - entity: binary_sensor.top_lock
                        name: Upper Lock
                      - entity: binary_sensor.bottom_lock
                        name: Bottom Lock

          - type: entities
            show_header_toggle: false
            state_color: true
            entities:
              - entity: binary_sensor.0x00158d00025371f6_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d000200ad58_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d0003fa6cf5_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d00025370d1_contact
                secondary_info: last-changed

          - type: entities
            show_header_toggle: false
            state_color: true
            entities:
              - entity: binary_sensor.0x00158d00027129ae_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d0001ef2ffc_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d0002a14c5e_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d0002529b9c_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d00025315e9_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d0001e5d6be_contact
                secondary_info: last-changed
              - entity: binary_sensor.582d344031f7_contact
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d0002531749_contact
                secondary_info: last-changed

      # - type: custom:auto-entities
      #   card:
      #     type: entities
      #   filter:
      #     include:
      #       - integration: xiaomi_gateway3
      #       - domain: binary_sensor
      #         attributes:
      #           device_class: motion
      #   sort:
      #     method: last_changed

      - type: entities
        show_header_toggle: false
        state_color: true
        entities:
          - entity: binary_sensor.0x00158d0001e53cda_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000224f89f_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0003140824_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000236bb94_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b43ad4_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001e05856_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b482e9_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001d5995e_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001ae9f61_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b4729d_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b48381_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000236bc6d_motion
            secondary_info: last-changed
          # - entity: binary_sensor.0x158d00024e58e7_motion
          #   secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001e54280_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001aea602_motion
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0003f27ce2_motion
            secondary_info: last-changed
          - entity: binary_sensor.54ef44c65722_motion
            secondary_info: last-changed
          - entity: binary_sensor.g5_flex_entrance_motion
            secondary_info: last-changed
          - entity: binary_sensor.g5_dome_hall_motion
            secondary_info: last-changed
          - type: divider
          - entity: binary_sensor.g4_doorbell_motion #binary_sensor.pinhole_motion
            secondary_info: last-changed
          - entity: binary_sensor.g5_turret_dixy_motion
            secondary_info: last-changed
          - entity: binary_sensor.g5_turret_street_motion
            secondary_info: last-changed
          - entity: binary_sensor.g5_bullet_window_motion
            secondary_info: last-changed
          - entity: binary_sensor.g5_bullet_yard_motion
            secondary_info: last-changed

  ################################################################
  # DEVICES BY ROOM PAGE
  ################################################################
  - title: Rooms
    icon: mdi:card-outline
    cards:
      - type: entities
        title: Vova Room
        show_header_toggle: false
        state_color: true
        entities:
          - light.square_led_v
          - light.square_led_v_nightlight
          - light.0x54ef441000d4e7fd_light
          #- light.gateway_light_7c49ebb19080
          #- remote.mi_remote
          - type: divider
          - switch.0x00158d0002395dc9_outlet
          - switch.0x00158d000246776f_outlet
          - switch.0x00158d000322e1d9_plug
          - type: divider
          - fan.purifier2s
          - type: divider
          #- switch.sonoff_1000d03987
          - switch.0x00158d000290a093_plug
          - switch.0x00158d000290a0bc_plug
          - type: divider
          - switch.shelly_1pm_led_v

      - type: entities
        title: Sasha Room
        show_header_toggle: false
        state_color: true
        entities:
          - light.square_led_s
          - light.0x54ef441000d54c6c_light
          - light.0x54ef4410000ea59b_light #light.led_color_s
          - type: divider
          - switch.0x00158d000239097a_outlet
          - switch.0x00158d0002395d58_outlet
          - switch.0x00158d0003535ee5_plug
          - switch.0x00158d0003600ea4_plug
          - type: divider
          - switch.shelly_1_led_s #switch.sonoff_mini_2_relay
      - type: entities
        title: Master Bedroom
        show_header_toggle: false
        state_color: true
        entities:
          - light.round_led_mb
          - light.round_led_mb_ambilight
          - light.0x54ef441000c88fa8_light
          - type: divider
          - switch.0x00158d000224e3e4_outlet
          - switch.0x00158d0002467773_outlet
          #- switch.0x158d000205a835_switch
          - switch.0x00158d000322e30c_plug
          - switch.0x00158d00028b4fc3_plug
          - switch.0x00158d00035c194f_plug
          - type: divider
          - switch.shelly_1_led_mb

      - type: entities
        title: Hall Big
        show_header_toggle: false
        state_color: true
        entities:
          - light.0x00158d000223921b_channel_1
          - light.0x00158d000253f04a_channel_2
          - light.esp32_strip_1s_wadrobe_hb_rgb
          - light.esp32_strip_1s_entrance_hb_rgb
          #- light.bedside
          #- light.gateway_light_7811dcb8cb4b
          - type: divider
          - switch.0x00158d0003539447_plug
          - switch.0x00158d0001f26071_outlet
          - switch.digma_strip_hb_relay1
          - switch.digma_strip_hb_relay2
          - switch.digma_strip_hb_relay3
          - switch.digma_strip_hb_relay4
          - switch.digma_strip_hb_relay5_usb
          - type: divider
          - switch.0x00158d000223921b_channel_2
          - switch.0x00158d000253f04a_channel_1
          - type: divider
          - switch.0x00158d000392623d_plug
          - switch.0x00158d000230fc52_outlet
          - switch.0x00158d00024517fe_outlet
          - switch.0x00158d0001f2630e_outlet
          - switch.0x00158d00023e5812_outlet

      - type: entities
        title: Kitchen
        show_header_toggle: false
        state_color: true
        entities:
          - light.round_led_k
          - light.esp32_node_k_light
          - light.esp8266_hood_k_main
          - light.d1mini_light_l_led
          - light.sonoff_mini_4_led
          - type: divider
          - fan.esp8266_hood_k_fan
          - type: divider
          - switch.0x00158d0002451850_outlet
          - switch.0x00158d0002476ed1_outlet
          - switch.0x00158d000249b25b_outlet
          - switch.0x00158d000353a2e3_plug
          - switch.0x00158d00028c9875_plug
          - switch.0x00158d00028a54e4_plug
          - switch.0x00158d00039258de_plug

          - type: divider
          - switch.0x00158d0001e85086_plug
          - switch.0x00158d0002a36f7f_channel_2

      - type: entities
        title: Hall Small
        show_header_toggle: false
        state_color: true
        entities:
          - light.round_led_hs
          - light.esp32_node_hs_led
          - type: divider
          - light.mono_strip_1_light
          # light.esp32_node_hs_wadrobe
          - light.esp32_node_hs_bathroom
          - light.esp32_node_hs_toilet
          - type: divider
          - switch.0x00158d0002a36433_channel_1
          - switch.0x00158d000249b26b_outlet
          - switch.0x00158d0002924790_plug

      - type: entities
        title: Bathroom
        show_header_toggle: false
        state_color: true
        entities:
          - light.0x00158d0002a36433_channel_2
          - light.mirror_light_b
          - type: divider
          - switch.sonoff_pow_r2_1_relay
          - fan.sonoff_pow_r2_1_bottom_fan
          - fan.esp32_node_b_fan_b
          - type: divider
          - switch.esp32_node_b_relay_2
          - switch.esp32_node_b_relay_1

      - type: entities
        title: Toilet
        show_header_toggle: false
        state_color: true
        entities:
          - light.0x00158d0002a36f7f_channel_1
          - light.esp32_node_b_light
          - type: divider
          - fan.esp32_node_b_fan_t

      - type: entities
        title: Storage
        show_header_toggle: false
        state_color: true
        entities:
          - light.round_led_st
          - light.0x54ef441000680083_channel_2

  ################################################################
  # SENSORS BY ROOM PAGE
  ################################################################
  - title: Sensors
    icon: mdi:album
    cards:
      - type: entities
        title: Hall Big
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.582d344031f7_contact #binary_sensor.0x00158d0001e5d6be_contact
          - binary_sensor.0x00158d0002531749_contact
          - binary_sensor.0x00158d0001d5995e_motion
          - binary_sensor.0x00158d0001e05856_motion
          - binary_sensor.0x00158d0002b482e9_motion
          #- sensor.0x158d00023d3206_action
          - sensor.ble_temperature_ble_freezer
          - sensor.ble_humidity_ble_freezer
          - sensor.0x00158d0002461e5b_temperature
          - sensor.0x00158d0002461e5b_humidity
          #- binary_sensor.vibration_158d0002b5fbc1
          #- sensor.bed_activity_158d0002b5fbc1
          #- sensor.coordination_158d0002b5fbc1
          #- sensor.tilt_angle_158d0002b5fbc1
          - sun.sun
      - type: entities
        title: Sasha Room
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.0x00158d00025370d1_contact
          - binary_sensor.0x00158d00027129ae_contact
          - binary_sensor.0x00158d000224f89f_motion
          - binary_sensor.0x00158d0003140824_motion
          - sensor.0x00158d0001e6d85a_temperature
          - sensor.0x00158d0001e6d85a_humidity

      - type: entities
        title: Kitchen
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.0x00158d00025371f6_contact
          - binary_sensor.0x00158d0002b4729d_motion
          - binary_sensor.0x00158d0002b48381_motion
          - binary_sensor.0x00158d00023297e7_moisture
          - sensor.0x00158d0001e586af_temperature
          - sensor.0x00158d0001e586af_humidity
          - binary_sensor.0x00158d00024bcf85_gas
          - binary_sensor.0x00158d0002c92f31_smoke
      - type: entities
        title: Vova Room
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.0x00158d0003fa6cf5_contact
          - binary_sensor.0x00158d0002529b9c_contact
          - binary_sensor.0x00158d000236bb94_motion
          - sensor.0x00158d00016bdb4a_action
          - sensor.0x00158d0001712d55_action
          - sensor.0x00158d0001e58714_temperature
          - sensor.0x00158d0001e58714_humidity
      - type: entities
        title: Hall Small
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.0x00158d0001ae9f61_motion
          - binary_sensor.0x00158d0002b43ad4_motion
      - type: entities
        title: Master Bedroom
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.0x00158d000200ad58_contact
          - binary_sensor.0x00158d00025315e9_contact
          - binary_sensor.0x00158d0001e53cda_motion
          - sensor.0x00158d00013e6aa5_action
          - sensor.0x00158d000222c746_temperature
          - sensor.0x00158d000222c746_humidity

      - type: entities
        title: Bathroom
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.0x00158d0002a14c5e_contact
          - binary_sensor.0x00158d000236bc6d_motion
          #- binary_sensor.0x158d00024e58e7_motion
          - sensor.0x00158d0001b94abe_action
          - binary_sensor.0x00158d0002373a67_moisture
          - sensor.0x00158d00020d7c3a_temperature
          - sensor.0x00158d00020d7c3a_humidity
      - type: entities
        title: Toilet
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.0x00158d000232ddd6_contact
          - binary_sensor.0x00158d0001ef2ffc_contact
          - binary_sensor.0x00158d0001e54280_motion
          - sensor.0x00158d0001b97111_action
          - binary_sensor.0x00158d00023684c2_moisture
          - sensor.0x00158d0001e58754_temperature
          - sensor.0x00158d0001e58754_humidity
      - type: entities
        title: Storage
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.0x00158d0001aea602_motion
          - binary_sensor.0x00158d0003f27ce2_motion
          #- sensor.0x158d00023d0b86_action
          - sensor.0x00158d000233fb72_temperature
          - sensor.0x00158d000233fb72_humidity
          - sensor.0x00158d000233fb72_pressure

  ################################################################
  # Curtain
  ################################################################
  # - title: Curtains
  #   icon: mdi:curtains
  - type: sections
    title: Curtains
     # path: home
    icon: mdi:curtains
     # badges:
     #   - type: entity
     #     entity: sensor.outdoor_temperature
     #     color: red
     #   - type: entity
     #     entity: sensor.outdoor_humidity
     #     color: indigo
     #   - type: entity
     #     entity: device_tracker.car
    sections:
      - cards:
          - type: heading
            heading: Sasha's room
            icon: mdi:sofa
            # badges:
            #   - type: entity
            #     entity: sensor.living_room_temperature
            #     color: red
            #   - type: entity
            #     entity: sensor.living_room_humidity
            #     color: indigo
          - type: tile
            entity: cover.1778091091590258688_motor
            features:
              - type: "cover-open-close"
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 1              
          - type: tile
            entity: cover.ccb5d1a3ebbf_motor
            name: Left
            features:
              - type: "cover-position"
          - type: tile
            entity: binary_sensor.ccb5d1a3ebbf_light
          - type: tile
            entity: sensor.ccb5d1a3ebbf_battery
          - type: tile
            entity: cover.ccb5d1a3eccf_motor
            name: Right
            features:
              - type: "cover-position"
          - type: tile
            entity: binary_sensor.ccb5d1a3eccf_light
          - type: tile
            entity: sensor.ccb5d1a3eccf_battery

    #sections:
      - cards:
          - type: heading
            heading: Master Bedroom
            icon: mdi:sofa
            # badges:
            #   - type: entity
            #     entity: sensor.living_room_temperature
            #     color: red
            #   - type: entity
            #     entity: sensor.living_room_humidity
            #     color: indigo
          - type: tile
            entity: cover.1778456713918824448_motor
            features:
              - type: "cover-open-close"
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 1              
          - type: tile
            entity: cover.ccb5d1a3e46d_motor
            name: Left
            features:
              - type: "cover-position"
          - type: tile
            entity: binary_sensor.ccb5d1a3e46d_light
          - type: tile
            entity: sensor.ccb5d1a3e46d_battery
          - type: tile
            entity: cover.ccb5d1a48621_motor
            name: Right
            features:
              - type: "cover-position"
          - type: tile
            entity: binary_sensor.ccb5d1a48621_light
          - type: tile
            entity: sensor.ccb5d1a48621_battery


  ################################################################
  # UTILITY COUNTERS PAGE
  ################################################################
  - title: Utility
    icon: mdi:counter
    cards:
      - type: vertical-stack
        cards:
          - type: glance
            state_color: true
            entities:
              - entity: sensor.esp32_node_b_hot_pipe
                name: Hot Pipe
              - entity: sensor.esp32_node_b_cold_pipe
                name: Cold Pipe
              - entity: sensor.esp32_node_mb_heating_pipe
                name: Heat MB
              - entity: sensor.esp32_node_v_heating_pipe
                name: Heat V

          - type: glance
            state_color: true
            entities:
              - entity: sensor.ms01a_daily_cost
                name: ms01a Daily Cost
              - entity: sensor.ms01a_monthly_cost
                name: ms01a Monthly Cost
          - type: glance
            state_color: true
            entities:
              - entity: sensor.ms01b_daily_cost
                name: ms01b Daily Cost
              - entity: sensor.ms01b_monthly_cost
                name: ms01b Monthly Cost
          - type: entities
            show_header_toggle: false
            state_color: true
            entities:
              - sensor.utility_cost
              - type: divider
              - type: divider
              - sensor.water_cost
              - type: divider
              - type: divider
              - sensor.power_cost
          - type: entities
            state_color: true
            entities:
              - input_number.tariff_energy_day
              - input_number.tariff_energy_night
              - type: divider
              - input_number.tariff_hot_water
              - input_number.tariff_cold_water
          - type: glance
            state_color: true
            entities:
              - entity: script.utility_counters_manual_reset
                name: All
              - entity: script.utility_counters_manual_reset_electricity
                name: Electricity
              - entity: script.utility_counters_manual_reset_water
                name: Water
      - type: vertical-stack
        cards:
          # - type: custom:mini-graph-card
          #   entities:
          #     - sensor.water_hour_single
          #   name: Water usage
          #   group_by: hour
          #   aggregate_func: max
          #   show:
          #     graph: bar
          #   line_color: blue
          #   icon: mdi:water-pump
          #   hours_to_show: 48
          #   points_per_hour: 1
          #   extrema: true
          #   labels: true
          #   line_width: 3
          #   decimals: 2
          #   hour24: true
          - type: "custom:mini-graph-card"
            color_thresholds:
              - color: "#039BE5"
                value: 0
              - color: "#0da035"
                value: 0.03
              - color: "#e0b400"
                value: 0.09
              - color: "#e45e65"
                value: 0.15
            color_thresholds_transition: hard
            entities:
              - entity: sensor.water_hour_single
                name: Water
              - color: "rgba(0,0,255,1)"
                entity: binary_sensor.dark_outside_mi
                show_line: false
                y_axis: secondary
            group: false
            group_by: hour
            hour24: true
            hours_to_show: 48
            line_width: 2
            points_per_hour: 4
            show:
              extrema: true
              fill: fade
              icon: true
              labels: false
              name: true
              state: true
              #graph: bar
            state_map:
              - label: Day
                value: "off"
              - label: Night
                value: "on"
            style: |
              ha-card {
                border: solid 2px var(--primary-color);
              }

          - type: entities
            title: Water
            show_header_toggle: false
            state_color: true
            entities:
              - input_number.hot_water_meter_month #sensor.hot_water_month
              - input_number.cold_water_meter_month #sensor.cold_water_month
              - type: divider
              # - sensor.hot_water_meter
              # - sensor.cold_water_meter
              - type: divider
              - input_number.hot_water_meter
              - input_number.cold_water_meter
              - type: divider
              - input_number.hot_water_meter_last_month
              - input_number.cold_water_meter_last_month
              # - type: divider
              # - entity: binary_sensor.0x00158d0006d31d78_contact
              #   name: Cold water sensor
              # - entity: binary_sensor.0x00158d000236fcd5_contact
              #   name: Hot water sensor

      - type: vertical-stack
        cards:
          - type: vertical-stack
            cards:
              # - type: custom:mini-graph-card
              #   icon: mdi:flash
              #   entities:
              #     - sensor.energy_hourly_single
              #     #- sensor.energy_xiaomi_hourly_single
              #   name: Power Consumption
              #   show:
              #     graph: bar
              #   line_color: red
              #   group_by: hour
              #   hours_to_show: 48
              #   points_per_hour: 1
              #   extrema: true
              #   labels: true
              #   line_width: 3
              #   decimals: 2
              #   hour24: true
              - type: "custom:mini-graph-card"
                color_thresholds:
                  - color: "#100000"
                    value: 0
                  - color: "#400000"
                    value: 50
                  - color: "#800000"
                    value: 500
                  - color: "#bf0000"
                    value: 800
                  - color: "#ff0000"
                    value: 1500
                color_thresholds_transition: hard
                entities:
                  - color: "#005500"
                    entity: sensor.esp32_pzem_hb_power_kw
                    name: Power
                    show_line: true
                  # - entity: sensor.energy_hourly_single #sensor.esp32_pzem_hb_power
                  #   name: Energy
                  #   color: '#FBB124'
                  - color: "rgba(0,0,255,1)"
                    entity: binary_sensor.dark_outside_mi
                    show_line: false
                    y_axis: secondary

                  # - color: '#cc261c'
                  #   entity: binary_sensor.tariff_t1
                  #   show_line: false
                  #   y_axis: secondary
                  #   name: T1
                  # - color: '#2e934c'
                  #   entity: binary_sensor.tariff_t2
                  #   show_line: false
                  #   y_axis: secondary
                  #   name: T2
                group: false
                group_by: hour
                hour24: true
                hours_to_show: 48
                line_width: 2
                points_per_hour: 4
                show:
                  extrema: true
                  fill: fade
                  icon: true
                  labels: false
                  name: true
                  state: true
                state_map:
                  - label: Day
                    value: "off"
                  - label: Night
                    value: "on"
                style: |
                  ha-card {
                    border: solid 2px var(--primary-color);
                  }

          - type: entities
            title: Power
            show_header_toggle: false
            state_color: true
            entities:
              - entity: sensor.esp32_pzem_hb_power_kw
                name: PZEM Power
              - entity: sensor.esp32_pzem_hb_energy_daily_day
                name: PZEM Daily Day
              - entity: sensor.esp32_pzem_hb_energy_daily_night
                name: PZEM Daily Night
              - type: divider
              - entity: sensor.esp32_pzem_hb_energy_daily
                name: PZEM Daily
              - type: divider
              - entity: sensor.esp32_pzem_hb_energy_monthly
                name: PZEM Monthly
              - type: divider
              - entity: sensor.esp32_pzem_hb_energy_monthly_day
                name: PZEM Monthly Day
              - entity: sensor.esp32_pzem_hb_energy_monthly_night
                name: PZEM Monthly Night
              - type: divider
              # - sensor.power_t1
              # - sensor.power_t2
              - type: divider
              - input_number.power_meter_t1
              - input_number.power_meter_t2
              - type: divider
              - input_number.power_meter_last_month_t1
              - input_number.power_meter_last_month_t2

  ################################################################
  # Rever Osmosis Statistics
  ################################################################
  - title: Revers Osmosis
    icon: mdi:filter
    cards:
      ##########################################
      # Left column
      ##########################################
      - type: vertical-stack
        cards:
          - type: entities
            #columns: 3
            state_color: true
            title: Status
            show_header_toggle: false
            entities:
              - button.yunmi_s20_2842_info
              - sensor.yunmi_s20_2842_status
              - binary_sensor.viomi_blues_pro_1200g_rinse
              - binary_sensor.viomi_blues_pro_1200g_fault
              - sensor.viomi_blues_pro_1200g_fault_code
              - sensor.viomi_blues_pro_1200g_custom_state_id

          - type: glance
            columns: 3
            state_color: true
            title: Quality
            entities:
              - entity: sensor.yunmi_s20_2842_total_dissolved_solids_for_input_water
                name: TDS In
              - entity: sensor.yunmi_s20_2842_total_dissolved_solids_for_output_water
                name: TDS Out
              - entity: sensor.yunmi_s20_2842_temperature
                name: T
          - type: glance
            columns: 2
            state_color: true
            title: Total Flows
            entities:
              - entity: sensor.viomi_blues_pro_1200g_cumu_flow_in
                name: In (Raw water)
              - entity: sensor.viomi_blues_pro_1200g_cumu_flow_out
                name: Out (Clear water)
          - type: entities
            state_color: true
            show_header_toggle: false
            title: Purifier Control
            entities:
              - entity: switch.0x00158d00039258de_plug
                name: Switch
              - entity: sensor.0x00158d00039258de_power
                name: Power

      - type: vertical-stack
        cards:
          - type: entities
            #columns: 3
            state_color: true
            title: Used Flow
            show_header_toggle: false
            entities:
              - sensor.yunmi_s20_2842_filter_used_time
              - sensor.yunmi_s20_2842_filter_used_time_2
              - sensor.yunmi_s20_2842_filter_used_time_3

          - type: entities
            #columns: 3
            state_color: true
            title: Used Flow
            show_header_toggle: false
            entities:
              - sensor.yunmi_s20_2842_filter_used_flow
              - sensor.yunmi_s20_2842_filter_used_flow_2
              - sensor.yunmi_s20_2842_filter_used_flow_3

          - type: entities
            #columns: 3
            state_color: true
            title: Life Level
            show_header_toggle: false
            entities:
              - sensor.yunmi_s20_2842_filter_life_level
              - sensor.yunmi_s20_2842_filter_life_level_2
              - sensor.yunmi_s20_2842_filter_life_level_3

      - type: vertical-stack
        cards:
          - type: entities
            #columns: 3
            state_color: true
            show_header_toggle: false
            title: Left Time
            entities:
              - sensor.yunmi_s20_2842_filter_left_time
              - sensor.yunmi_s20_2842_filter_left_time_2
              - sensor.yunmi_s20_2842_filter_left_time_3
          - type: entities
            #columns: 3
            state_color: true
            show_header_toggle: false
            title: Left Flow
            entities:
              - sensor.yunmi_s20_2842_filter_left_flow
              - sensor.yunmi_s20_2842_filter_left_flow_2
              - sensor.yunmi_s20_2842_filter_left_flow_3

  ################################################################
  # POWER LOADS PAGE
  ################################################################
  - title: Socket Loads
    icon: mdi:flash
    cards:
      ##########################################
      # Left column
      ##########################################
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            cards:
              - type: gauge
                name: A PZEM
                entity: sensor.esp32_pzem_hb_current
                max: 40
                severity:
                  green: 1
                  yellow: 20
                  red: 30
              - type: gauge
                name: A EM
                entity: sensor.shellyemg3_e4b063d422e8_energy_meter_0_current
                max: 40
                severity:
                  green: 1
                  yellow: 20
                  red: 30
          - type: horizontal-stack
            cards:
              - type: gauge
                name: V PZEM
                entity: sensor.esp32_pzem_hb_voltage
                min: 200
                max: 240
                severity:
                  green: 215
                  yellow: 120
                  red: 50
              - type: gauge
                name: V EM
                entity: sensor.shellyemg3_e4b063d422e8_energy_meter_0_voltage
                min: 200
                max: 240
                severity:
                  green: 215
                  yellow: 120
                  red: 50
          - type: horizontal-stack
            cards:
              - type: gauge
                name: P PZEM
                entity: sensor.esp32_pzem_hb_power
                max: 8800
                severity:
                  green: 100
                  yellow: 5000
                  red: 7000
              - type: gauge
                name: P EM
                entity: sensor.shellyemg3_e4b063d422e8_energy_meter_0_power
                max: 8800
                severity:
                  green: 100
                  yellow: 5000
                  red: 7000
              # - type: gauge
              #   name: Mercury 200
              #   entity: sensor.esp32_domofon_power_meter
              #   max: 8800
              #   severity:
              #     green: 100
              #     yellow: 5000
              #     red: 7000
          # - type: glance
          #   state_color: true
          #   columns: 4
          #   entities:
          #     - entity: sensor.esp32_pzem_hb_energy_monthly_day
          #       name: PZEM Day
          #     - entity: sensor.esp32_pzem_hb_energy_monthly_night
          #       name: PZEM Day

          - type: glance
            title: By Room
            state_color: true
            entities:
              - entity: sensor.power_consumption_mb
                name: MB
              - entity: sensor.power_consumption_v
                name: V
              - entity: sensor.power_consumption_s
                name: S
              - entity: sensor.power_consumption_hb
                name: HB
              - entity: sensor.power_consumption_hs
                name: HS
              - entity: sensor.power_consumption_k
                name: K
              - entity: sensor.power_consumption_b
                name: B
              - entity: sensor.power_consumption_t
                name: T
              - entity: sensor.power_consumption_st
                name: St

          - type: glance
            title: Main Lights
            state_color: true
            entities:
              - entity: sensor.shelly_1pm_led_v_power
                name: Square LED V
      ##########################################
      # Mid column
      ##########################################
      - type: vertical-stack
        cards:
          - type: entities
            title: Hall Big
            show_header_toggle: false
            state_color: true
            entities:
              - entity: sensor.ms01a_plug_hb_power
                name: ms01a Plug HB
              - entity: sensor.ms01b_plug_hb_power
                name: ms01b Plug HB
              - entity: sensor.0x00158d0003539447_power
                name: Plug Fridge HB
              - entity: sensor.0x00158d000230fc52_power
                name: Socket Fridge HB
              - entity: sensor.0x00158d00024517fe_power
                name: Socket Entrance HB
              - entity: sensor.0x00158d0001f2630e_power
                name: Socket Wadrobe L HB
              - entity: sensor.0x00158d00023e5812_power
                name: Socket Wadrobe R HB
              - entity: sensor.0x00158d0001f26071_power #sensor.0x00158d000358c773_power
                name: Socker Door HB

          - type: entities
            title: Hall Small
            show_header_toggle: false
            state_color: true
            entities:
              - entity: sensor.0x00158d000249b26b_power
                name: Socket Main HS
              - entity: sensor.0x00158d0002924790_power
                name: Plug Utility HS
              - type: divider
              - entity: sensor.sonoff_pow_r2_1_power
                name: Plug Washer B
              # - entity: sensor.shp6_socket_2_w
              #   name: Plug D-Link NAS
              # - entity: sensor.shp2_socket_1_w
              #   name: Plug MQTT Brix

          - type: entities
            title: Master bedroom
            show_header_toggle: false
            state_color: true
            entities:
              - entity: sensor.0x00158d000224e3e4_power
                name: Socket Entrance MB
              - entity: sensor.0x00158d0002467773_power
                name: Socket PC MB
              # - entity: sensor.0x158d000205a835_power
              #   name: Plug LED Color MB
              - entity: sensor.0x00158d000322e30c_power
                name: Plug Wadrobe MB
              - entity: sensor.0x00158d00035c194f_power
                name: Plug PC MB
              - entity: sensor.0x00158d00028b4fc3_power
                name: Plug Monitor MB
              - entity: sensor.0x00158d000345119e_power
                name: Plug Breather MB
              # - entity: sensor.0x00158d0002c3d86e_power
              #   name: Plug LED Strip MB
              # - entity: sensor.shp6_socket_1_w
              #   name: Plug n2830 MB
              # - entity: sensor.ds220plus_plug_hs_power
              #   name: Plug DS220J MB
              - entity: sensor.ds920plus_plug_mb_power
                name: Plug DS920+ MB

          - type: entities
            title: Storage
            show_header_toggle: false
            state_color: true
            entities:
              - entity: sensor.sonoff_pow_r2_3_power
                name: St
              - entity: sensor.1621_plug_st_power
                name: DS1621+ Plug St
              - entity: sensor.ds920plus_plug_mb_power
                name: DS920+ Plug St

      ##########################################
      # Right column
      ##########################################
      - type: vertical-stack
        cards:
          - type: entities
            title: Sasha
            show_header_toggle: false
            state_color: true
            entities:
              - entity: sensor.0x00158d000239097a_power
                name: Socket PC S
              - entity: sensor.0x00158d0002395d58_power
                name: Socket Wadrobe S
              - entity: sensor.0x00158d00036148b9_power
                name: Plug Breather S
              - entity: sensor.0x00158d0003535ee5_power
                name: Plug PC S
              - entity: sensor.0x00158d0003600ea4_power
                name: Plug Dell Monitor S
              # - entity: sensor.avatto_socket_1_w
              #   name: Plug Top Wadrobe LED
              - entity: sensor.plug_table_s_power
                name: Plug Top Wadrobe PC S
              - entity: sensor.shellyplug_s_c50295_power
                name: Plug Top S

          - type: entities
            title: Vova
            show_header_toggle: false
            state_color: true
            entities:
              - entity: sensor.0x00158d000246776f_power
                name: Socket Entrance V
              - entity: sensor.0x00158d0002395dc9_power
                name: Socket TV V
              - entity: sensor.0x00158d000322e1d9_power
                name: Plug Wadrobe V
              - entity: sensor.0x00158d000344998e_power
                name: Plug Breather V
              - entity: sensor.0x00158d000290a0bc_power
                name: Plug TV Box V
              - entity: sensor.0x00158d000290a093_power
                name: Plug TV V
              - entity: sensor.shelly_1pm_led_v_power
                name: Square LED V

          - type: entities
            title: Kitchen
            show_header_toggle: false
            state_color: true
            entities:
              - entity: sensor.0x00158d0002451850_power
                name: Socket PC K
              - entity: sensor.0x00158d0002476ed1_power
                name: Socket TV K
              - entity: sensor.0x00158d000249b25b_power
                name: Socket Oven K
              - entity: sensor.0x00158d0001e85086_power
                name: Plug TV K
              - entity: sensor.0x00158d000353a2e3_power
                name: Plug Top K
              - entity: sensor.0x00158d00028c9875_power
                name: Plug Kettle K
              - entity: sensor.0x00158d00028a54e4_power
                name: Plug Microwave K
              - entity: sensor.0x00158d00039258de_power
                name: Plug RO Pump K

  ################################################################
  # DEVICE TRACKERS PAGE
  ################################################################
  # - title: Device trackers
  #   icon: mdi:map-search #mdi:router-network
  #   cards:
  #     - type: entities
  #       title: Smart Home
  #       show_header_toggle: false
  #       state_color: true
  #       entities:
  #         #- device_tracker.bedside_lamp_mb
  #         - device_tracker.led_white_s #device_tracker.philips_e27_s
  #         - device_tracker.led_white_mb #device_tracker.philips_e27_mb
  #         - device_tracker.led_color_s
  #         - device_tracker.led_color_mb
  #         - device_tracker.round_led_k
  #         - device_tracker.round_led_mb
  #         - device_tracker.round_led_hs
  #         - device_tracker.square_led_v
  #         - device_tracker.square_led_s
  #         - device_tracker.led_strip_hb
  #         - device_tracker.led_strip_entrance_hb
  #         - type: divider
  #         - device_tracker.gateway3_hb
  #         # - device_tracker.gateway_plug_entrance_hb
  #         - device_tracker.gateway3_hs
  #         - device_tracker.gateway3_k
  #         # - device_tracker.gateway_v
  #         - device_tracker.gateway3_s
  #         # - device_tracker.gateway_mb
  #         - type: divider
  #         - device_tracker.gateway_plug_hb
  #         - device_tracker.gateway_plug_entrance_hb
  #         - device_tracker.gateway_plug_hs
  #         - device_tracker.gateway_plug_k
  #         # - device_tracker.gateway_plug_v_2
  #         #- device_tracker.gateway_plug_s
  #         # - device_tracker.gateway_plug_mb_2
  #         #- device_tracker.server_plug_hb
  #         # - device_tracker.power_strip_wifi
  #         # - device_tracker.power_strip_s
  #         # - device_tracker.round_led_s_switch
  #         - type: divider
  #         #- device_tracker.humidifier_2
  #         - device_tracker.purifier_2s_mb
  #         # - type: divider
  #         # - device_tracker.mi_ir_controller

  #     - type: entities
  #       title: Phones
  #       show_header_toggle: false
  #       state_color: true
  #       entities:
  #         - device_tracker.life360_dima_tsymbal
  #         - device_tracker.iphone_8_dima
  #         - device_tracker.iphone_8_dtsymbal
  #         #- device_tracker.iphone8_ping
  #         - device_tracker.meizu_m2_mini
  #         - device_tracker.mimax_2

  #         - type: divider
  #         - device_tracker.life360_sandra_tsymbal
  #         - device_tracker.iphone_se_sandra_unifi
  #         - device_tracker.iphone_se_sandra
  #         #- device_tracker.iphone_7_sasha
  #         #- device_tracker.iphone7_ping
  #         - device_tracker.iphone_6

  #         - type: divider
  #         - device_tracker.life360_vova_tsymbal
  #         #- device_tracker.mimax2_ping

  #         - type: divider
  #         - device_tracker.iphone_5s

  #         - type: divider
  #         - device_tracker.ipad_sasha
  #         - device_tracker.ipad_dima

  #     - type: entities
  #       title: PCs
  #       show_header_toggle: false
  #       state_color: true
  #       entities:
  #         #- device_tracker.x10srl_ipmi
  #         #- device_tracker.main_server
  #         - device_tracker.i5_mod
  #         - device_tracker.dell_m6800_wifi
  #         #- device_tracker.dell_m6800_lan
  #         #- device_tracker.r418_wifi
  #         - device_tracker.lenovo_u430p_wifi
  #         - device_tracker.brix_3455_lan
  #         #- device_tracker.brix_3455_wifi
  #         - device_tracker.rpi_lan
  #         - device_tracker.j3455_lan
  #         #- device_tracker.a722_board

  #     - type: entities
  #       title: Network
  #       show_header_toggle: false
  #       state_color: true
  #       entities:
  #         #- device_tracker.main_gate
  #         #- device_tracker.cloud_key
  #         - device_tracker.main_switch_16_150w
  #         - device_tracker.switch_8_60_k
  #         - device_tracker.switch_8_60_s
  #         - device_tracker.switch_8_60_mb
  #         - device_tracker.ap_pro_hb
  #         - device_tracker.ap_pro_hs
  #         - device_tracker.ap_pro_s
  #         - device_tracker.ap_v
  #         - device_tracker.ap_mb
  #         - device_tracker.ap_nanohd_hb

  #     - type: entities
  #       title: Others
  #       show_header_toggle: false
  #       state_color: true
  #       entities:
  #         - device_tracker.d_link_dns_320l
  #         - device_tracker.mi_box_v
  #         - device_tracker.mi_stick_k
  #         - device_tracker.checkmachine
  #         - device_tracker.hp_178nw
  #         - device_tracker.security_system

  #     - type: entities
  #       title: Cameras
  #       show_header_toggle: false
  #       state_color: true
  #       entities:
  #         - device_tracker.g3_flex_dixy
  #         - device_tracker.g3_flex_window
  #         - device_tracker.g3_flex_hall
  #         - device_tracker.g3_flex_entrance
  #         - device_tracker.g3_flex_street
  #         - type: divider
  #         #- device_tracker.roundcam
  #         #- device_tracker.square_cam_hs
  #         - device_tracker.360_camera_hb
  #         - device_tracker.digma_division_100
  #         - device_tracker.door_cam_hb

  #     - type: entities
  #       title: Home Mini
  #       show_header_toggle: false
  #       state_color: true
  #       entities:
  #         - device_tracker.yandex_lite_k #home_mini_k
  #         - device_tracker.yandex_lite_v #home_mini_v
  #         - device_tracker.yandex_lite_s #home_mini_s
  #         - device_tracker.yandex_lite_mb #home_mini_mb
  #         - device_tracker.yandex_lite_hb #home_mini_hb

  #      - type: entities
  #        title: Boards
  #        show_header_toggle: false
  #        state_color: true
  #        entities:
  #          - device_tracker.rpi_cam_wifi
  #          - device_tracker.rpi_zero
  #          - device_tracker.pi_zero2_mb
  #          - device_tracker.pi_zero2_mqtt
  #          - device_tracker.pi_zero2_test2

  # - type: entities
  #   title: ESPs
  #   show_header_toggle: false
  #   state_color: true
  #   entities:
  #     #- device_tracker.esp01_hdd
  #     - device_tracker.esp32_domofon
  #     - device_tracker.esp32_node_k_main
  #     - device_tracker.esp32_water_filter

  #     - device_tracker.sonoff_mini
  #     - device_tracker.sonoff_4ch

  # - type: entities
  #   title: CO2 sensors
  #   show_header_toggle: false
  #   state_color: true
  #   entities:
  #     - device_tracker.d1_mini_co2_mb
  #     - device_tracker.d1_mini_co2_v
  #     - device_tracker.d1_mini_co2_s

  ################################################################
  # Cameras PAGE
  ################################################################
  - title: Cameras
    icon: mdi:cctv
    cards:
      - type: vertical-stack
        cards:
          - type: custom:webrtc-camera
            url: g4_doorbell
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse
            style: "video {aspect-ratio: 16/9; object-fit: fill;}"

          - type: custom:webrtc-camera
            url: g4_doorbell_package
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse
            style: "video {aspect-ratio: 16/9; object-fit: fill;}"

          - type: custom:webrtc-camera
            url: g5_hall
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse

      - type: vertical-stack
        cards:
          - type: custom:webrtc-camera
            url: g4_instant
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse

          - type: custom:webrtc-camera
            url: g5_dixy
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse

          - type: custom:webrtc-camera
            url: g5_window
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse

          - type: custom:webrtc-camera
            url: g4_instant_st
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse

      - type: vertical-stack
        cards:
          - type: custom:webrtc-camera
            url: g5_entrance
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse

          - type: custom:webrtc-camera
            url: g5_street
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse

          - type: custom:webrtc-camera
            url: g5_yard
            ui: false
            muted: true
            intersection: 0.50
            background: false
            #mode: mse

  - title: Maps
    icon: mdi:map
    cards:
      - type: vertical-stack
        cards:
          - type: glance
            state_color: true
            entities:
              - entity: switch.system_security_mode
                name: Security
                tap_action:
                  action: toggle
              - entity: binary_sensor.family_home
                name: Family
              # - entity: binary_sensor.family_home_extended
              #   name: Extended
              - entity: sensor.people_home
                name: At Home
              - entity: counter.main_door_hb
                name: In\Out
          - type: glance
            entities:
              - input_select.dima_status_dropdown
              - input_select.sandra_status_dropdown
              - input_select.vova_status_dropdown
              - input_select.sasha_status_dropdown
          - type: glance
            state_color: true
            entities:
              - entity: sensor.home_dima_distance
                name: Dima
              - entity: sensor.home_2_sandra_distance
                name: Sandra
              - entity: sensor.home_3_vova_distance
                name: Vova
              - entity: sensor.home_4_sasha_distance
                name: Sasha
      - type: vertical-stack
        cards:
          - type: map
            aspect_ratio: "16x9"
            default_zoom: 16
            hours_to_show: 24
            entities:
              - person.dima
          - type: map
            aspect_ratio: "16x9"
            default_zoom: 16
            hours_to_show: 24
            entities:
              - person.sandra
          - type: map
            aspect_ratio: "16x9"
            default_zoom: 16
            hours_to_show: 24
            entities:
              - person.sandra2
      - type: vertical-stack
        cards:
          - type: map
            aspect_ratio: "16x9"
            default_zoom: 16
            hours_to_show: 24
            entities:
              - person.vova
          - type: map
            aspect_ratio: "16x9"
            default_zoom: 16
            hours_to_show: 24
            entities:
              - person.sasha

  ################################################################
  # CLIMATE PAGE
  ################################################################
  - title: Climate
    icon: mdi:air-purifier
    cards:
      - type: vertical-stack
        cards:
          - type: entities
            show_header_toggle: false
            state_color: true
            entities:
              - entity: fan.purifier2s
              - type: divider
              - entity: sensor.purifier2s_pm2_5
                name: PM2.5
                icon: mdi:meteor
              - entity: sensor.purifier_mode
                name: Mode
                tap_action:
                  action: perform-action
                  perform_action: script.cycle_purifier_mode
              - entity: sensor.purifier2s_filter_lifetime_remaining
                name: Filter left

      - type: vertical-stack
        cards:
          - type: glance
            state_color: true
            columns: 4
            entities:
              - entity: sensor.esp32_node_v_co2
                name: V
              - entity: sensor.esp32_node_s_co2
                name: S
              - entity: sensor.esp32_node_mb_co2
                name: MB
              - entity: sensor.esp32_node_k_co2
                name: K
              - entity: sensor.0x00158d0001e58714_temperature
                name: V
              - entity: sensor.0x00158d0001e6d85a_temperature
                name: S
              - entity: sensor.0x00158d000222c746_temperature
                name: MB
              - entity: sensor.0x00158d0001e586af_temperature
                name: K

          - type: glance
            state_color: true
            show_state: false
            columns: 9
            entities:
              - entity: fan.breather_v
                name: V
                tap_action:
                  action: toggle
              - entity: binary_sensor.0x00158d0003fa6cf5_contact
                name: Window
              - entity: switch.0x00158d000344998e_plug
                name: Plug
              - entity: button.digma_ir_v_breather_pwr
                name: PWR
                tap_action:
                  action: toggle
              - entity: button.digma_ir_v_breather_down
                name: Down
                tap_action:
                  action: toggle
              - entity: button.digma_ir_v_breather_up
                name: Up
                tap_action:
                  action: toggle
              - entity: switch.system_breather_auto_v
                name: Auto
                tap_action:
                  action: toggle
              - entity: switch.system_breather_manual_v
                name: M
                tap_action:
                  action: toggle
              - entity: switch.system_breather_auto_speed_v
                name: ASp
                tap_action:
                  action: toggle

              - entity: fan.breather_s
                name: S
                tap_action:
                  action: toggle
              - entity: binary_sensor.0x00158d00025370d1_contact
                name: Window
              - entity: switch.0x00158d00036148b9_plug
                name: Plug
              - entity: button.digma_ir_s_breather_pwr
                name: PWR
                tap_action:
                  action: toggle
              - entity: button.digma_ir_s_breather_down
                name: Down
                tap_action:
                  action: toggle
              - entity: button.digma_ir_s_breather_up
                name: Up
                tap_action:
                  action: toggle
              - entity: switch.system_breather_auto_s
                name: Auto
                tap_action:
                  action: toggle
              - entity: switch.system_breather_manual_s
                name: M
                tap_action:
                  action: toggle
              - entity: switch.system_breather_auto_speed_s
                name: ASp
                tap_action:
                  action: toggle

              - entity: fan.breather_mb
                name: MB
                tap_action:
                  action: toggle
              - entity: binary_sensor.0x00158d000200ad58_contact
                name: Window
              - entity: switch.0x00158d000345119e_plug
                name: Plug
              - entity: button.digma_ir_mb_breather_pwr
                name: PWR
                tap_action:
                  action: toggle
              - entity: button.digma_ir_mb_breather_down
                name: Down
                tap_action:
                  action: toggle
              - entity: button.digma_ir_mb_breather_up
                name: Up
                tap_action:
                  action: toggle
              - entity: switch.system_breather_auto_mb
                name: Auto
                tap_action:
                  action: toggle
              - entity: switch.system_breather_manual_mb
                name: M
                tap_action:
                  action: toggle
              - entity: switch.system_breather_auto_speed_mb
                name: ASp
                tap_action:
                  action: toggle
          - type: glance
            state_color: true
            show_state: true
            entities:
              - entity: sensor.0x00158d000344998e_power
                name: V
              - entity: sensor.0x00158d00036148b9_power
                name: S
              - entity: sensor.0x00158d000345119e_power
                name: MB
          - type: entities
            entities:
              - entity: switch.system_hourly_mode_breather_v
                name: Auto Br V
                tap_action:
                  action: toggle
              - input_number.co2_low_limit
              - input_number.co2_high_limit
              - entity: input_number.low_speed_for_timer_mode_breather_v
                name: Low speed
              - entity: input_number.high_speed_for_timer_mode_breather_v
                name: High speed
              - input_select.breazer_timer
              - entity: timer.breather_v
                name: Timer Breather V
                double_tap_action:
                  action: perform-action
                  perform_action: timer.finish
                  data:
                    entity_id: timer.breather_v

              - type: attribute
                entity: fan.breather_v
                attribute: percentage
                name: Breather V Current Speed
          - type: entities
            title: Actual Speed
            show_header_toggle: false
            entities:
              - entity: fan.breather_v
                type: attribute
                attribute: percentage
                name: V
              - entity: fan.breather_s
                type: attribute
                attribute: percentage
                name: S
              - entity: fan.breather_mb
                type: attribute
                attribute: percentage
                name: MB
          - type: entities
            title: Recommended Speed
            show_header_toggle: false
            entities:
              - entity: sensor.breather_set_speed_v
                name: V
              - entity: sensor.breather_set_speed_s
                name: S
              - entity: sensor.breather_set_speed_mb
                name: MB
          - type: glance
            title: Calibration
            state_color: true
            show_state: false
            columns: 4
            entities:
              - entity: button.esp32_node_v_co2_calibrate
                name: V
              - entity: button.esp32_node_s_co2_calibrate
                name: S
              - entity: button.esp32_node_mb_co2_calibrate
                name: MB
              - entity: button.esp32_node_k_co2_calibrate
                name: K

      - type: vertical-stack
        cards:
          - type: history-graph
            hours_to_show: 48
            #title: 'CO2 V'
            entities:
              - sensor.esp32_node_v_co2
          - type: history-graph
            hours_to_show: 48
            #title: 'CO2 S'
            entities:
              - sensor.esp32_node_s_co2
          - type: history-graph
            hours_to_show: 48
            #title: 'CO2 MB'
            entities:
              - sensor.esp32_node_mb_co2
          - type: history-graph
            hours_to_show: 48
            #title: 'CO2 K'
            entities:
              - sensor.esp32_node_k_co2

  ################################################################
  # SYSTEM MONITORING PAGE
  ################################################################
  - title: System Details
    icon: mdi:cog-outline
    cards:
      - type: vertical-stack
        cards:
          - type: custom:stack-in-card
            mode: vertical
            cards:
              - type: glance
                state_color: true
                entities:
                  - entity: binary_sensor.tod_day
                    name: TOD
                  - entity: input_datetime.day_start_workday
                    name: Work Day
                  - entity: input_datetime.day_start_holiday
                    name: Holiday
                  - entity: input_datetime.day_end
                    name: End
              - type: glance
                entities:
                  - entity: input_number.light_temperature_high
                    name: High
                  - entity: input_number.light_temperature_low
                    name: Low
              - type: entities
                state_color: true
                entities:
                  - entity: input_number.inside_light_level
                  - entity: input_number.outside_light_level
                  - entity: binary_sensor.light_outside_mi
                  - entity: binary_sensor.dark_outside_mi
              - type: glance
                entities:
                  - entity: sensor.0x04cf8cdf3c77271d_illuminance
                  - entity: sensor.0x04cf8cdf3c78d26e_illuminance
                  - entity: sensor.0x04cf8cdf3c7754a8_illuminance
          - type: entities
            entities:
              - script.addons_start
          - type: entities
            state_color: true
            entities:
              - entity: input_number.battery_low_level_zb
              - entity: input_number.battery_low_level_bt
              - entity: automation.system_battery_level_check
                name: Check now
                show_state: false
                tap_action:
                  action: perform-action
                  perform_action: automation.trigger
                  data:
                    entity_id: automation.system_battery_level_check
          - type: vertical-stack
            cards:
              - type: entities
                state_color: true
                entities:
                  - input_select.main_audio_out
                  - input_number.main_volume
                  - input_select.alice_mode
                  - script.tts_test
                  - switch.system_silent_mode
          # - type: glance
          #   columns: 8
          #   state_color: true
          #   entities:
          #     - entity: switch.shp2_socket_1_relay
          #       name: MQTT
          #       tap_action: none
          #     - entity: sensor.shp2_socket_1_w
          #       name: ""

          #     - entity: switch.shp6_socket_2_relay
          #       name: NAS
          #       tap_action: none
          #     - entity: sensor.shp6_socket_2_w
          #       name: ""

          #     - entity: switch.shp6_socket_1_relay
          #       name: n2830
          #       tap_action: none
          #     - entity: sensor.shp6_socket_1_w
          #       name: ""

          #     - entity: switch.0x00158d0002c3d86e_plug
          #       name: LED MB
          #       tap_action: none
          #     - entity: sensor.0x00158d0002c3d86e_power
          #       name: ""
          - type: glance
            columns: 6
            state_color: true
            entities:
              - entity: switch.pc_v
                name: PCv
              - entity: switch.0x00158d00035c194f_plug
                name: PCv Plug
                tap_action: none
              - entity: sensor.0x00158d00035c194f_power
                name: PCv P
              - entity: switch.0x00158d00028b4fc3_plug
                name: MonV Plug
              - entity: binary_sensor.monitor_mb
                name: MonV
              - entity: sensor.0x00158d00028b4fc3_power
                name: MonV P

              - entity: switch.pc_s
                name: PCs
              - entity: switch.0x00158d0003535ee5_plug
                name: PCs Plug
                tap_action: none
              - entity: sensor.0x00158d0003535ee5_power
                name: PCs P
              - entity: switch.0x00158d0003600ea4_plug
                name: MonS Plug
              - entity: binary_sensor.monitor_s
                name: MonS
              - entity: sensor.0x00158d0003600ea4_power
                name: MonS P

          # - type: glance
          #   columns: 3
          #   state_color: true
          #   entities:
          #     - entity: switch.vovapc
          #       name: PCv
          #       hold_action: none
          #       tap_action:
          #         action: toggle
          #     - entity: switch.sashapc
          #       name: PCs
          #       hold_action: none
          #       tap_action:
          #         action: toggle
          #     # - entity: switch.r418
          #     #   name: R418
          #     #   hold_action: none
          #     #   tap_action:
          #     #     action: toggle
          #     - entity: switch.u430p
          #       name: U430P
          #       hold_action: none
          #       tap_action:
          #         action: toggle
          #     # - entity: switch.brix3160_lan
          #     #   name: BRIX 3160
          #     #   hold_action: none
          #     #   tap_action:
          #     #     action: toggle
          - type: entities
            state_color: true
            entities:
              - entity: sensor.db_size
                name: MariaDB
              #- sensor.db_size_change_1h
              - type: divider
              #- sensor.influxdb_size
              - entity: sensor.influxdb_folder_size
                name: InfluxDB
              #   sensor.influxdb_total_size #sensor.influxdb_size
              # - sensor.influxdb_internal_size
              # - sensor.influxdb_hass_autogen_size
              # - sensor.influxdb_hass_infinite_size
              #- sensor.influxdb_size_change_1h
              #- sensor.influxdb_folder_size_change_1h
              # - type: call-service
              #   icon: mdi:database-minus
              #   name: Purge 0
              #   action_name: Purge
              #   service: recorder.purge
              #   service_data:
              #     keep_days: 0
              #     repack: true
              # - type: call-service
              #   icon: mdi:database-minus
              #   name: Purge 1
              #   action_name: Purge
              #   service: recorder.purge
              #   service_data:
              #     keep_days: 1
              #     repack: true
              # - type: call-service
              #   icon: mdi:database-minus
              #   name: Purge 2
              #   action_name: Purge
              #   service: recorder.purge
              #   service_data:
              #     keep_days: 2
              #     repack: true

          # - type: glance
          #   state_color: true
          #   entities:
          #     - entity: switch.esp01_hdd_box_power
          #       name: USB HDD
          #       tap_action:
          #         action: toggle
          #     - entity: binary_sensor.esp01_hdd_box_powerstatus
          #       name: Status
          #       tap_action:
          #         action: call-service
          #         service: switch.toggle
          #         service_data:
          #           entity_id: switch.esp01_hdd_box_power
          #     - entity: binary_sensor.esp01_hdd_box_status
          #       name: Connection

      # Mid column
      #############
      - type: vertical-stack
        cards:
          # - type: history-graph
          #   entities:
          #     - entity: remote.0x588e81fffedcb38d_pair
          #       name: HB
          #     - entity: remote.0x842e14fffe1508a6_pair
          #       name: HS
          #     - entity: remote.0x588e81fffedd3c41_pair
          #       name: S
          #     - entity: remote.0x588e81fffe72678e_pair
          #       name: K
          # - type: glance
          #   columns: 8
          #   entities:
          #     - entity: sensor.gw3_hb_radio_channel
          #       name: HB
          #     - entity: sensor.gw3_hb_radio_tx_power
          #       name:
          #     - entity: sensor.gw3_hs_radio_channel
          #       name: HS
          #     - entity: sensor.gw3_hs_radio_tx_power
          #       name:
          #     - entity: sensor.gw3_s_radio_channel
          #       name: S
          #     - entity: sensor.gw3_s_radio_tx_power
          #       name:
          #     - entity: sensor.gw3_k_radio_channel
          #       name: K
          #     - entity: sensor.gw3_k_radio_tx_power
          #       name:
          - type: glance
            columns: 3
            entities:
              # - entity: binary_sensor.unifi_controller_state
              #   name: Unifi Controller
              # - entity: binary_sensor.dns1
              #   name: DNS1
              #   icon: mdi:dns
              # - entity: binary_sensor.dns8
              #   name: DNS8
              #   icon: mdi:dns
              # - entity: binary_sensor.telegram_api
              #   name: TG
              #- entity: binary_sensor.mqtt_state
              #  name: MQTT
              # - entity: binary_sensor.hass_backup_state
              #   name: Backup-hass
              - entity: sensor.gw3_zigbee_devices_count
                name: ZB devices
              - entity: sensor.gw3_bt_devices_count
                name: BT
              - entity: sensor.gw3_mesh_devices_count
                name: Mesh
              #- entity: binary_sensor.rpi_state
              #  name: RPI
              #- entity: binary_sensor.nuc_state
              #  name: NUC
          - type: glance
            columns: 5
            entities:
              - entity: sensor.zigbee_gateways_unavailable
                name: GW
              - entity: sensor.zigbee_devices_unavailable
                name: Z
              - entity: sensor.ble_devices_stats_unavailable
                name: BLE
              - entity: sensor.mesh_devices_stats_unavailable
                name: Mesh
              - entity: sensor.wifi_devices_unavailable
                name: WiFi

          - type: glance
            columns: 6
            entities:
              - entity: sensor.gw3_hb_zigbee_devices_count
                name: HB
              - entity: sensor.gw3_hs_zigbee_devices_count
                name: HS
              - entity: sensor.gw3_s_zigbee_devices_count
                name: S
              - entity: sensor.gw3_v_zigbee_devices_count
                name: V
              - entity: sensor.gw3_mb_zigbee_devices_count
                name: MB
              - entity: sensor.gw3_k_zigbee_devices_count
                name: K

          # - type: glance
          #   state_color: true
          #   entities:
          #     - entity: sensor.to4ko_myconfig_stars
          #       name: GitStars
          #     - entity: sensor.system_config_line_count_ratio
          #       name: Config Ratio
          #     - entity: sensor.system_config_line_count
          #       name: Total Lines
          #     - entity: sensor.system_config_line_count_code
          #       name: Code Lines

          - type: custom:stack-in-card
            mode: vertical
            cards:
              - type: glance
                columns: 4
                state_color: true
                entities:
                  # - entity: sensor.mqtt_broker_uptime_text
                  #   name: MQTT Up
                  - entity: sensor.start_time_cmd
                    name: HA Init
                  - entity: sensor.ha_uptime_text
                    name: HA Up
                  - entity: sensor.host_uptime_text
                    name: VM Up
                    icon: mdi:clock-outline
                  - entity: sensor.ms01a_uptime_text
                    name: ms01 Up
              - type: glance
                state_color: true
                columns: 7
                entities:
                  - entity: counter.badlogin_counter
                    name: Bad Logins
                  - entity: counter.restart_counter
                    name: Restarts
                    hold_action:
                      action: perform-action
                      confirmation: true
                      perform_action: script.error_reset
                  - entity: counter.error_counter
                    name: Errors
                  - entity: sensor.error_counter_hourly
                    name: perH
                  - entity: counter.warning_counter
                    name: Warnings
                    hold_action:
                      action: perform-action
                      confirmation: true
                      perform_action: script.warning_reset
                  - entity: sensor.warning_counter_hourly
                    name: perH
                  - entity: counter.automation_error_counter
                    name: A Errors
                    hold_action:
                      action: perform-action
                      confirmation: true
                      perform_action: script.error_reset

              # - type: glance
              #   show_header_toggle: false
              #   state_color: true
              #   entities:
              #     - entity: sensor.gdrive_backup_state
              #       icon: mdi:google-drive
              #       name: G-BU Status
              #     - entity: binary_sensor.backups_stale
              #       name: G-BU Stale
              #     - entity: sensor.gdrive_last_backup
              #       icon: mdi:clock-digital
              #       name: G-BU Last
          - type: horizontal-stack
            cards:
              - type: glance
                state_color: true
                entities:
                  - entity: binary_sensor.hass_backup_ping
                    name: backup-hass
                  - entity: binary_sensor.hass_backup_state
                    name: HA
                    icon: mdi:home-assistant
                  - entity: binary_sensor.hass_backup_automation
                    name: Auto
                  - entity: binary_sensor.hass_backup_lead
                    name: Lead
          # - type: glance
          #   entities:
          #     - entity: sensor.watchman_last_updated
          #       name: Updated
          #       tap_action:
          #         action: call-service
          #         service: watchman.report
          #         service_data:
          #           create_file: true
          #           send_notification: false
          #           service: notify.telegram
          #           data:
          #             parse_mode: html
          #           parse_config: true
          #           chunk_size: true
          #     - entity: sensor.watchman_missing_entities
          #       name: Entities
          #     - entity: sensor.watchman_missing_services
          #       name: Services
          - type: custom:auto-entities
            show_empty: false
            card:
              type: entities
              show_header_toggle: false
              state_color: true
            filter:
              include:
                - domain: timer
              exclude:
                - state: "idle"

              # - type: glance
              #   state_color: true
              #   entities:
              #     - entity: binary_sensor.rpi
              #       name: RPI
              #     - entity: binary_sensor.rpi_state
              #       name: HA
              #       icon: mdi:home-assistant
              #     - entity: binary_sensor.rpi_automation
              #       name: Auto

              #     - entity: binary_sensor.rpi_lead
              #       name: Lead

      # ############
      # Right column
      ##############
      - type: vertical-stack
        cards:
          # ######################################
          # Load bars for 12 threads CPU (Ryzen 3600)
          # ######################################
          # - type: custom:bar-card
          #   title_position: top
          #   columns: 3
          #   height: 20px
          #   min: 0
          #   max: 24.4
          #   target: 19
          #   severity:
          #     - value: 3
          #       color: '#40bf40'
          #     - value: 6
          #       color: '#bf9540'
          #     - value: 9
          #       color: '#bf4040'
          #     - value: 12
          #       color: '#ff0000'
          #   padding: 2px
          #   direction: right
          #   entities:
          #     - sensor.load_1m
          #     - sensor.load_5m
          #     - sensor.load_15m
          - type: custom:bar-card
            columns: 3
            height: 30px
            min: 0
            max: 14
            target: 10
            positions:
              icon: "off"
              indicator: inside
              name: inside
            severity:
              - color: "#40bf40"
                from: 0
                to: 4
              - color: "#bf9540"
                from: 4
                to: 8
              - color: "#bf4040"
                from: 8
                to: 12
              - color: "#ff0000"
                from: 12
                to: 20
            padding: 2px
            direction: right
            entities:
              - entity: sensor.load_1m
                name: Load 1
              - entity: sensor.load_5m
                name: Load 5
              - entity: sensor.load_15m
                name: Load 15
          # - type: custom:stack-in-card
          #   mode: vertical
          #   cards:
          #     - type: custom:bar-card
          #       columns: 3
          #       height: 30px
          #       min: 20
          #       max: 100
          #       positions:
          #         icon: "off"
          #         indicator: inside
          #         name: inside
          #       severity:
          #         - color: "#40bf40"
          #           from: 0
          #           to: 45
          #         - color: "#bf9540"
          #           from: 45
          #           to: 55
          #         - color: "#bf4040"
          #           from: 55
          #           to: 65
          #         - color: "#ff0000"
          #           from: 65
          #           to: 100
          #       padding: 2px
          #       direction: right
          #       entities:
          #         - sensor.ipmi_cpu_temp
          #         - sensor.ipmi_pch_temp
          #         - sensor.ipmi_system_temp

          #     - type: glance
          #       #title: Ubuntu Status
          #       columns: 5
          #       state_color: true
          #       entities:
          #         - entity: sensor.ssd_usage
          #           icon: mdi:chip
          #           name: "/"
          #         - entity: sensor.nvme2_usage
          #           icon: mdi:chip
          #           name: DB
          #         # - entity: sensor.media_usage
          #         #   icon: mdi:harddisk
          #         #   name: M
          #         - entity: sensor.temp_usage
          #           icon: mdi:harddisk
          #           name: T
          #         - entity: sensor.back_2tb_usage
          #           icon: mdi:harddisk
          #           name: Back_2Tb
          #         - entity: sensor.320l_usage
          #           name: 320l

          #- type: custom:vertical-stack-in-card
          - type: vertical-stack
            cards:
              - type: conditional
                conditions:
                  - condition: state
                    entity: binary_sensor.ippon_1500_status
                    state_not: "off"
                card:
                  type: glance
                  columns: 2
                  state_color: true
                  entities:
                    - entity: sensor.ippon_1500_status_data
                      name: HB
                    - entity: sensor.ippon_1500_load
                      name: Load
                    # - entity: sensor.ippon_1200_battery_runtime
                    #   name: Runtime
                    # - entity: sensor.ippon_1500_battery_charge
                    #   name: Charge
                    #- entity: sensor.ippon_1200_battery_voltage
                    #  name: Voltage
                    # - entity: sensor.ippon_1200_input_voltage
                    #   name: Input
                    # - entity: sensor.ippon_1200_output_voltage
                    #   name: Output
              - type: conditional
                conditions:
                  - condition: state
                    entity: binary_sensor.ippon_1050_status
                    state_not: "off"
                card:
                  type: glance
                  columns: 2
                  state_color: true
                  entities:
                    - entity: sensor.ippon_1050_status_data
                      name: St
                    - entity: sensor.ippon_1050_load
                      name: Load
                    # - entity: sensor.ippon_1050_battery_runtime
                    #   name: Runtime
                    # - entity: sensor.ippon_1050_battery_charge
                    #   name: Charge
                    #- entity: sensor.ippon_1050_battery_voltage
                    #  name: Voltage
                    # - entity: sensor.ippon_1050_input_voltage
                    #   name: Input
                    # - entity: sensor.ippon_1050_output_voltage
                    #   name: Output
              # - type: conditional
              #   conditions:
              #     - entity: binary_sensor.cyber_650_status
              #       state_not: "off"
              #   card:
              #     type: glance
              #     columns: 3
              #     state_color: true
              #     entities:
              #       - entity: sensor.cyber_650_status_data
              #         name: K
              #       - entity: sensor.cyber_650_load
              #         name: Load
              #       # - entity: sensor.cyber_650_battery_runtime
              #       #   name: Runtime
              #       - entity: sensor.cyber_650_battery_charge
              #         name: Charge
              #       #- entity: sensor.cyber_650_battery_voltage
              #       #  name: Voltage
              #       # - entity: sensor.cyber_650_input_voltage
              #       #   name: Input
              #       # - entity: sensor.cyber_650_output_voltage
              #       #   name: Output
              # - type: conditional
              #   conditions:
              #     - entity: binary_sensor.ippon_650_status
              #       state_not: "off"
              #   card:
              #     type: glance
              #     columns: 3
              #     state_color: true
              #     entities:
              #       - entity: sensor.ippon_650_status_data
              #         name: S
              #       - entity: sensor.ippon_650_load
              #         name: Load
              #       # - entity: sensor.ippon_650_battery_runtime
              #       #   name: Runtime
              #       - entity: sensor.ippon_650_battery_charge
              #         name: Charge
              #       #- entity: sensor.cyber_650_battery_voltage
              #       #  name: Voltage
              #       # - entity: sensor.ippon_650_input_voltage
              #       #   name: Input
              #       # - entity: sensor.ippon_650_output_voltage
              #       #   name: Output

          - type: glance
            columns: 7
            state_color: true
            entities:
              - entity: switch.blackhole_turtle_mode
                name: Turtle
                icon: mdi:turtle
                tap_action:
                  action: toggle
              - entity: sensor.blackhole_status
                name: Status
              - entity: sensor.blackhole_down_speed
                name: DL
              - entity: sensor.blackhole_up_speed
                name: UL
              - entity: sensor.blackhole_total_torrents
                name: Total
              - entity: sensor.blackhole_active_torrents
                name: Active
              - entity: sensor.blackhole_completed_torrents
                name: Completed
          # - type: custom:stack-in-card
          #   mode: vertical
          #   cards:
          #     - type: horizontal-stack
          #       cards:
          # - type: glance
          #   show_state: false
          #   show_name: false
          #   entities:
          #     - entity: script.speedtest_manual
          #       name: Test
          #       icon: mdi:recycle
          #       tap_action:
          #         action: call-service
          #         service: script.speedtest_manual
          # - type: "custom:mini-graph-card"
          #   entities:
          #     - entity: sensor.speedtest_download
          #       name: Download
          #       show_state: true
          #     - entity: sensor.speedtest_upload
          #       name: Upload
          #       show_state: true
          # font_size: 70
          # hour24: true
          # hours_to_show: 24
          # name: Speedtest
          # points_per_hour: 1
          # unit: Mbit/s
          # tap_action:
          #   action: perform-action
          #   perform_action: script.speedtest_manual

          # - type: history-graph
          #   hours_to_show: 48
          #   entities:
          #     - entity: sensor.speedtest_download
          #       name: Download
          #       show_state: true
          #     - entity: sensor.speedtest_upload
          #       name: Upload

          - type: glance
            columns: 6
            state_color: true
            entities:
              - entity: sensor.devices
                name: Dev
              - entity: sensor.entities
                name: Ent
              - entity: sensor.device_trackers
                name: Trkrs
              - entity: sensor.lights
                name: Lght
              - entity: sensor.sensors
                name: Sens
              - entity: sensor.binary_sensors
                name: B-Sens
              - entity: sensor.switches
                name: Sw
              - entity: sensor.automations
                name: Auto
              - entity: sensor.scripts
                name: Scrpts

              - entity: sensor.air_quality
                name: AirQ
              - entity: sensor.alarm_control_panels
                name: AlPanels
              - entity: sensor.areas
                name: Areas
              - entity: sensor.buttons
                name: Buttons
              - entity: sensor.calendars
                name: Calendars
              - entity: sensor.cameras
                name: Cams
              - entity: sensor.climate
                name: Climate
              - entity: sensor.covers
                name: Covers
              - entity: sensor.fans
                name: Fans
              - entity: sensor.humidifiers
                name: Humi
              - entity: sensor.integrations
                name: Integr
              - entity: sensor.custom_integrations
                name: CIntegr
              - entity: sensor.locks
                name: Locks
              - entity: sensor.media_players
                name: MediaP
              - entity: sensor.numbers
                name: Numbers
              - entity: sensor.persons
                name: Persons
              - entity: sensor.remotes
                name: Remotes
              - entity: sensor.scenes
                name: Scenes
              - entity: sensor.selects
                name: Selects
              - entity: sensor.sirens
                name: Sirens
              - entity: sensor.suns
                name: Suns
              - entity: sensor.texts
                name: TXTs
              - entity: sensor.vacuums
                name: Vacs
              - entity: sensor.update
                name: Updts
              - entity: sensor.water_heaters
                name: WHeaters
              - entity: sensor.weather
                name: Weathers
              - entity: sensor.zones
                name: Zones

  ################################################################
  # Main System Health
  ################################################################
  - title: System Health
    icon: mdi:server-network
    cards:
      # - type: vertical-stack
      #   title: pmox01 i5-1340p
      #   cards:
      #     # - type: custom:bar-card
      #     #   columns: 3
      #     #   height: 30px
      #     #   min: 0
      #     #   max: 14
      #     #   target: 10
      #     #   positions:
      #     #     icon: "off"
      #     #     indicator: inside
      #     #     name: inside
      #     #   severity:
      #     #     - color: "#40bf40"
      #     #       from: 0
      #     #       to: 4
      #     #     - color: "#bf9540"
      #     #       from: 4
      #     #       to: 8
      #     #     - color: "#bf4040"
      #     #       from: 8
      #     #       to: 12
      #     #     - color: "#ff0000"
      #     #       from: 12
      #     #       to: 20
      #     #   padding: 2px
      #     #   direction: right
      #     #   entities:
      #     #     - sensor.load_1m
      #     #     - sensor.load_5m
      #     #     - sensor.load_15m
      #     - type: glance
      #       #title: Main Host Status
      #       columns: 5
      #       state_color: true
      #       entities:
      #         - entity: sensor.pmox01_cpu_temp #sensor.processor_temperature
      #           name: CPUT
      #         - entity: sensor.pmox01_cpu_load
      #           name: CPU
      #         - entity: sensor.pmox01_memory_used
      #           name: RAM
      #           icon: mdi:chip
      #         - entity: sensor.pmox01_iowait
      #           name: iowait
      #         - entity: sensor.pmox01_uptime_text
      #           name: pmox1 Up

      #     - type: glance
      #       columns: 5
      #       state_color: true
      #       entities:
      #         - entity: switch.server_plug_hb
      #           name: S.Plug
      #           tap_action: none
      #           hold_action: none
      #         - entity: sensor.server_plug_hb_power
      #           name: P
      #         - entity: sensor.server_power_12h_avg
      #           name: 12h avg
      #         - entity: sensor.server_daily_cost
      #           name: Cost Daily
      #         - entity: sensor.server_monthly_cost
      #           name: Monthly

      #     - type: glance
      #       columns: 6
      #       state_color: true
      #       entities:
      #         # NVME 0
      #         - entity: sensor.pmox01_nvme0_tb_written
      #           name: NVME Tot W
      #           icon: mdi:raspberry-pi
      #         - entity: sensor.pmox01_nvme0_session_read
      #           name: R Session
      #         - entity: sensor.pmox01_nvme0_session_write
      #           name: W Session
      #         - entity: sensor.pmox01_nvme0_write_change_1h
      #           name: W\h
      #         - entity: sensor.pmox01_nvme0_life_left_smart
      #           name: "%"
      #         - entity: sensor.pmox01_nvme0_temp
      #           name: T
      #     - type: glance
      #       columns: 6
      #       state_color: true
      #       entities:
      #         # NVME 0
      #         - entity: sensor.pmox01_sda_tb_written
      #           name: SDA Tot W
      #           icon: mdi:raspberry-pi
      #         - entity: sensor.pmox01_sda_session_read
      #           name: R Session
      #         - entity: sensor.pmox01_sda_session_write
      #           name: W Session
      #         - entity: sensor.pmox01_sda_write_change_1h
      #           name: W\h
      #         - entity: sensor.pmox01_sda_life_left_smart
      #           name: "%"
      #         - entity: sensor.pmox01_sda_temp
      #           name: T
      #     - type: glance
      #       columns: 3
      #       state_color: true
      #       entities:
      #         - entity: sensor.pmox01_enp86s0_speed
      #           name: enps86s0
      #         - entity: sensor.pmox01_enx1cbfce6c8014_speed
      #           name: enx1cbfce6c8014
      #         - entity: sensor.pmox01_enp4s0_speed
      #           name: enp4s0

      - type: vertical-stack
        title: MS01a i9-13900H
        cards:
          - type: glance
            #title: Main Host Status
            columns: 5
            state_color: true
            entities:
              - entity: sensor.ms01a_cpu_temp #sensor.processor_temperature
                name: CPUT
              - entity: sensor.ms01a_cpu_load
                name: CPU
              - entity: sensor.ms01a_memory_used
                name: RAM
                icon: mdi:chip
              - entity: sensor.ms01a_iowait
                name: iowait
              - entity: sensor.ms01a_uptime_text
                name: MS01 Up

          - type: glance
            columns: 5
            state_color: true
            entities:
              - entity: switch.ms01a_plug_hb
                name: P.Plug
                tap_action: none
                hold_action: none
              - entity: sensor.ms01a_plug_hb_power
                name: P
              - entity: sensor.ms01a_power_12h_avg
                name: 12h avg
              - entity: sensor.ms01a_daily_cost
                name: Cost Daily
              - entity: sensor.ms01a_monthly_cost
                name: Monthly
          - type: glance
            columns: 2
            state_color: true
            entities:
              # Fan1
              - entity: sensor.ms01a_fan_1
                name: SSD Fan
              - entity: sensor.ms01a_fan_2
                name: CPU Fan

          - type: glance
            columns: 6
            state_color: true
            entities:
              # NVME 0
              - entity: sensor.ms01a_nvme1_tb_written
                name: PM9A3 Tot W
                icon: mdi:raspberry-pi
              - entity: sensor.ms01a_nvme1_session_read
                name: R Session
              - entity: sensor.ms01a_nvme1_session_write
                name: W Session
              - entity: sensor.ms01a_nvme1_write_change_1h
                name: W\h
              - entity: sensor.ms01a_nvme1_life_left_smart
                name: "%"
              - entity: sensor.ms01a_nvme1_temp
                name: T

          - type: glance
            columns: 6
            state_color: true
            entities:
              # NVME 0
              - entity: sensor.ms01a_nvme0_tb_written
                name: PM9A1 Tot W
                icon: mdi:raspberry-pi
              - entity: sensor.ms01a_nvme0_session_read
                name: R Session
              - entity: sensor.ms01a_nvme0_session_write
                name: W Session
              - entity: sensor.ms01a_nvme0_write_change_1h
                name: W\h
              - entity: sensor.ms01a_nvme0_life_left_smart
                name: "%"
              - entity: sensor.ms01a_nvme0_temp
                name: T

          - type: glance
            columns: 4
            state_color: true
            entities:
              - entity: sensor.ms01a_enp88s0_speed
                name: i226-V
              - entity: sensor.ms01a_enp90s0_speed
                name: i226-LM
              - entity: sensor.ms01a_enp3s0f0np0_speed
                name: x710_1
              - entity: sensor.ms01a_enp3s0f1np1_speed
                name: x710_2

          - type: glance
            columns: 4
            state_color: true
            entities:
              - entity: sensor.ms01a_enp1s0f0_speed
                name: i350_1
              - entity: sensor.ms01a_enp1s0f1_speed
                name: i350_2
              - entity: sensor.ms01a_enp1s0f2_speed
                name: i350_3
              - entity: sensor.ms01a_enp1s0f3_speed
                name: i350_4

      - type: vertical-stack
        title: MS01b i9-12900H
        cards:
          - type: glance
            #title: Main Host Status
            columns: 5
            state_color: true
            entities:
              - entity: sensor.ms01b_cpu_temp #sensor.processor_temperature
                name: CPUT
              - entity: sensor.ms01b_cpu_load
                name: CPU
              - entity: sensor.ms01b_memory_used
                name: RAM
                icon: mdi:chip
              - entity: sensor.ms01b_iowait
                name: iowait
              - entity: sensor.ms01b_uptime_text
                name: MS01b Up

          - type: glance
            columns: 5
            state_color: true
            entities:
              - entity: switch.ms01b_plug_hb
                name: P.Plug
                tap_action: none
                hold_action: none
              - entity: sensor.ms01b_plug_hb_power
                name: P
              - entity: sensor.ms01b_power_12h_avg
                name: 12h avg
              - entity: sensor.ms01b_daily_cost
                name: Cost Daily
              - entity: sensor.ms01b_monthly_cost
                name: Monthly

          - type: glance
            columns: 2
            state_color: true
            entities:
              # Fan1
              - entity: sensor.ms01b_fan_1
                name: SSD Fan
              - entity: sensor.ms01b_fan_2
                name: CPU Fan

          - type: glance
            columns: 6
            state_color: true
            entities:
              # NVME 0
              - entity: sensor.ms01b_nvme1_tb_written
                name: 7400 Tot W
                icon: mdi:raspberry-pi
              - entity: sensor.ms01b_nvme1_session_read
                name: R Session
              - entity: sensor.ms01b_nvme1_session_write
                name: W Session
              - entity: sensor.ms01b_nvme1_write_change_1h
                name: W\h
              - entity: sensor.ms01b_nvme1_life_left_smart
                name: "%"
              - entity: sensor.ms01b_nvme1_temp
                name: T

          - type: glance
            columns: 6
            state_color: true
            entities:
              # NVME 0
              - entity: sensor.ms01b_nvme0_tb_written
                name: PM9A1 Tot W
                icon: mdi:raspberry-pi
              - entity: sensor.ms01b_nvme0_session_read
                name: R Session
              - entity: sensor.ms01b_nvme0_session_write
                name: W Session
              - entity: sensor.ms01b_nvme0_write_change_1h
                name: W\h
              - entity: sensor.ms01b_nvme0_life_left_smart
                name: "%"
              - entity: sensor.ms01b_nvme0_temp
                name: T

          - type: glance
            columns: 4
            state_color: true
            entities:
              - entity: sensor.ms01b_enp88s0_speed
                name: i226-V
              - entity: sensor.ms01b_enp90s0_speed
                name: i226-LM
              - entity: sensor.ms01b_enp3s0f0np0_speed
                name: x710_1
              - entity: sensor.ms01b_enp3s0f1np1_speed
                name: x710_2

          - type: glance
            columns: 4
            state_color: true
            entities:
              - entity: sensor.ms01b_enp1s0f0_speed
                name: i350_1
              - entity: sensor.ms01b_enp1s0f1_speed
                name: i350_2
              - entity: sensor.ms01b_enp1s0f2_speed
                name: i350_3
              - entity: sensor.ms01b_enp1s0f3_speed
                name: i350_4

      - type: vertical-stack
        title: Unifi & PiKVM
        cards:
          - type: glance
            columns: 7
            state_color: true
            entities:
              - entity: sensor.udm_cpu_use
                name: UDM CPU
              - entity: sensor.udm_cpu_temp
                name: CPUT
              - entity: sensor.udm_flash_temp
                name: B_T
              - entity: sensor.udm_mem_used
                name: MEM
              - entity: sensor.usw24_temp
                name: USWT
              - entity: sensor.usw24_fan_speed
                name: Fan
              - entity: binary_sensor.udmpmax_home_hdd_1
                name: HDD
          - type: glance
            columns: 5
            state_color: true
            entities:
              - entity: sensor.switch_ent_24_poe_temperature
                name: Ent24
              - entity: sensor.switch_ent_8_s_temperature
                name: Ent8 S
              - entity: sensor.switch_ent_8_hs_temperature
                name: Ent8 HS
              - entity: sensor.switch_ent_8_mb_temperature
                name: Ent8 MB
              - entity: sensor.switch_proaggr_hb_temperature
                name: ProAggr

          - type: glance
            columns: 5
            state_color: true
            entities:
              - entity: binary_sensor.udm_wan1_up
                name: WAN1 UP
              - entity: binary_sensor.udm_wan2_up
                name: WAN2 UP
              - entity: sensor.udm_active_wan
                name: Active WAN
              - entity: binary_sensor.udm_wan1_uplink
                name: WAN1 Link
              - entity: binary_sensor.udm_wan2_uplink
                name: WAN2 Link
          - type: glance
            columns: 2
            state_color: true
            entities:
              - entity: sensor.udm_wan_name
                name: WAN Name
              - entity: sensor.udm_last_active_ip
                name: WAN IP
          - type: glance
            columns: 2
            state_color: true
            entities:
              - entity: sensor.pikvm_cpu_load
                name: PiKVM CPU
              - entity: sensor.pikvm_cpu_temp
                name: CPUT

          - type: glance
            columns: 3
            state_color: true
            entities:
              - entity: sensor.rpi3_cpu_load
                name: RPI3 CPU
              - entity: sensor.rpi3_cpu_temp
                name: CPUT
              - entity: sensor.rpi3_memory_used
                name: Mem Used

  ################################################################
  # NAS System Health
  ################################################################
  - title: Synology
    icon: mdi:nas
    cards:
      - type: vertical-stack
        title: DS1621+
        cards:
          - type: glance
            columns: 6
            entities:
              - entity: update.ds1621plus_dsm_update
                name: Update
              - entity: sensor.ds1621plus_cpu_utilization_total
                name: CPU
              - entity: sensor.ds1621plus_temperature
                name: CPUT
              - entity: sensor.ds1621plus_memory_usage_real
                name: RAM
              - entity: sensor.ds1621plus_monthly_cost
                name: Cost
              - entity: sensor.1621_plug_st_power
                name: Power

          - type: glance
            columns: 4
            entities:
              - entity: sensor.ds1621plus_fan_speed
                name: Current Fan Speed
              - entity: input_select.ds1621_fan_speed_select
                name: Set Fan Speed
              - entity: sensor.ds1621plus_fan1_rpm
                name: Fan1
              - entity: sensor.ds1621plus_fan2_rpm
                name: Fan2

          - type: glance
            columns: 4
            entities:
              - entity: sensor.ds1621plus_volume_1_volume_used
                name: Tank
              - entity: sensor.ds1621plus_volume_1_status
                name: Tank
              - entity: sensor.ds1621plus_drive_temperature_max
                name: Max T
              - entity: sensor.ds1621plus_drive_temperature_max_6h
                name: Max T 6h

          - type: glance
            columns: 8
            entities:
              - entity: sensor.ds1621plus_drive_1_temperature
                name: "T #1"
              - entity: sensor.ds1621plus_drive_2_temperature
                name: "#2"
              - entity: sensor.ds1621plus_drive_3_temperature
                name: "#3"
              - entity: sensor.ds1621plus_drive_4_temperature
                name: "#4"
              - entity: sensor.ds1621plus_drive_5_temperature
                name: "#5"
              - entity: sensor.ds1621plus_drive_6_temperature
                name: "#6"
              - entity: sensor.ds1621plus_m_2_drive_1_temperature
                name: "NVME 1"
              - entity: sensor.ds1621plus_m_2_drive_2_temperature
                name: "NVME 2"
          # - type: glance
          #   columns: 6
          #   entities:
          #     - binary_sensor.ds1621plus_disk_1_below_min_remaining_life
          #     - binary_sensor.ds1621plus_disk_2_below_min_remaining_life
          #     - binary_sensor.ds1621plus_disk_4_below_min_remaining_life
          #     - binary_sensor.ds1621plus_disk_5_below_min_remaining_life
          #     - binary_sensor.ds1621plus_disk_6_below_min_remaining_life
          #     - binary_sensor.ds1621plus_nvme_1_below_min_remaining_life
          - type: glance
            columns: 8
            entities:
              - entity: binary_sensor.ds1621plus_drive_1_exceeded_max_bad_sectors
                name: "BSct #1"
              - entity: binary_sensor.ds1621plus_drive_2_exceeded_max_bad_sectors
                name: "#2"
              - entity: binary_sensor.ds1621plus_drive_3_exceeded_max_bad_sectors
                name: "#3"
              - entity: binary_sensor.ds1621plus_drive_4_exceeded_max_bad_sectors
                name: "#4"
              - entity: binary_sensor.ds1621plus_drive_5_exceeded_max_bad_sectors
                name: "#5"
              - entity: binary_sensor.ds1621plus_drive_6_exceeded_max_bad_sectors
                name: "#6"
              - entity: binary_sensor.ds1621plus_m_2_drive_1_exceeded_max_bad_sectors
                name: "NVME 1"
              - entity: binary_sensor.ds1621plus_m_2_drive_2_exceeded_max_bad_sectors
                name: "NVME 2"

          - type: glance
            columns: 8
            entities:
              - entity: sensor.ds1621plus_drive_1_status
                name: "Status #1"
              - entity: sensor.ds1621plus_drive_2_status
                name: "#2"
              - entity: sensor.ds1621plus_drive_3_status
                name: "#3"
              - entity: sensor.ds1621plus_drive_4_status
                name: "#4"
              - entity: sensor.ds1621plus_drive_5_status
                name: "#5"
              - entity: sensor.ds1621plus_drive_6_status
                name: "#6"
              - entity: sensor.ds1621plus_m_2_drive_1_status
                name: "NVME 1"
              - entity: sensor.ds1621plus_m_2_drive_2_status
                name: "NVME 2"
          - type: glance
            columns: 8
            entities:
              - entity: sensor.ds1621plus_drive_1_status_smart
                name: "SMART #1"
              - entity: sensor.ds1621plus_drive_2_status_smart
                name: "#2"
              - entity: sensor.ds1621plus_drive_3_status_smart
                name: "#3"
              - entity: sensor.ds1621plus_drive_4_status_smart
                name: "#4"
              - entity: sensor.ds1621plus_drive_5_status_smart
                name: "#5"
              - entity: sensor.ds1621plus_drive_6_status_smart
                name: "#6"
              - entity: sensor.ds1621plus_m_2_drive_1_status_smart
                name: "NVME 1"
              - entity: sensor.ds1621plus_m_2_drive_2_status_smart
                name: "NVME 2"

      # - type: vertical-stack
      #   title: DS920+
      #   cards:
      #     - type: glance
      #       columns: 6
      #       entities:
      #         - entity: update.ds920plus_dsm_update
      #           name: Update
      #         - entity: sensor.ds920plus_cpu_utilization_total
      #           name: CPU
      #         - entity: sensor.ds920plus_temperature
      #           name: CPUT
      #         - entity: sensor.ds920plus_memory_usage_real
      #           name: RAM
      #         - entity: sensor.ds920plus_monthly_cost
      #           name: Cost
      #         - entity: sensor.ds920plus_plug_mb_power
      #           name: Power
      #     - type: custom:stack-in-card
      #       mode: horizontal
      #       cards:
      #         - type: glance
      #           columns: 2
      #           entities:
      #             - entity: sensor.ds920plus_volume_1_volume_used
      #               name: Storage
      #             - entity: sensor.ds920plus_volume_2_volume_used
      #               name: Fast

      #         - type: glance
      #           columns: 2
      #           entities:
      #             - entity: sensor.ds920plus_volume_1_status
      #               name: Storage
      #             - entity: sensor.ds920plus_volume_2_status
      #               name: Fast

      #     - type: glance
      #       columns: 6
      #       entities:
      #         - entity: sensor.ds920plus_drive_1_temperature
      #           name: "T #1"
      #         - entity: sensor.ds920plus_drive_2_temperature
      #           name: "#2"
      #         - entity: sensor.ds920plus_drive_3_temperature
      #           name: "#3"
      #         - entity: sensor.ds920plus_drive_4_temperature
      #           name: "#4"
      #         - entity: sensor.ds920plus_cache_device_1_temperature
      #           name: "NVME 1"
      #         - entity: sensor.ds920plus_cache_device_2_temperature
      #           name: "NVME 2"

      #     - type: glance
      #       columns: 6
      #       entities:
      #         - entity: binary_sensor.ds920plus_drive_1_exceeded_max_bad_sectors
      #           name: "BSct #1"
      #         - entity: binary_sensor.ds920plus_drive_2_exceeded_max_bad_sectors
      #           name: "#2"
      #         - entity: binary_sensor.ds920plus_drive_3_exceeded_max_bad_sectors
      #           name: "#3"
      #         - entity: binary_sensor.ds920plus_drive_4_exceeded_max_bad_sectors
      #           name: "#4"
      #         - entity: binary_sensor.ds920plus_cache_device_1_exceeded_max_bad_sectors
      #           name: "NVME 1"
      #         - entity: binary_sensor.ds920plus_cache_device_2_exceeded_max_bad_sectors
      #           name: "NVME 2"

      #     - type: glance
      #       columns: 6
      #       entities:
      #         - entity: sensor.ds920plus_drive_1_status
      #           name: "Status #1"
      #         - entity: sensor.ds920plus_drive_2_status
      #           name: "#2"
      #         - entity: sensor.ds920plus_drive_3_status
      #           name: "#3"
      #         - entity: sensor.ds920plus_drive_4_status
      #           name: "#4"
      #         - entity: sensor.ds920plus_cache_device_1_status
      #           name: "NVME 1"
      #         - entity: sensor.ds920plus_cache_device_2_status
      #           name: "NVME 2"

      #     - type: glance
      #       columns: 6
      #       entities:
      #         - entity: sensor.ds920plus_drive_1_status_smart
      #           name: "SMART #1"
      #         - entity: sensor.ds920plus_drive_2_status_smart
      #           name: "#2"
      #         - entity: sensor.ds920plus_drive_3_status_smart
      #           name: "#3"
      #         - entity: sensor.ds920plus_drive_4_status_smart
      #           name: "#4"
      #         - entity: sensor.ds920plus_cache_device_1_status_smart
      #           name: "NVME 1"
      #         - entity: sensor.ds920plus_cache_device_2_status_smart
      #           name: "NVME 2"

      - type: vertical-stack
        title: PBS R5-4500U
        cards:
          - type: glance
            #title: Main Host Status
            columns: 5
            state_color: true
            entities:
              - entity: sensor.pbs100_cpu_temp #sensor.processor_temperature
                name: CPUT
              - entity: sensor.pbs100_cpu_load
                name: CPU
              - entity: sensor.pbs100_memory_used
                name: RAM
                icon: mdi:chip
              - entity: sensor.pbs100_iowait
                name: iowait
              - entity: sensor.pbs100_uptime_text
                name: Uptime

          - type: glance
            columns: 5
            state_color: true
            entities:
              - entity: switch.pbs100_plug_st
                name: P.Plug
                tap_action: none
                hold_action: none
              - entity: sensor.pbs100_plug_st_power
                name: P
              - entity: sensor.pbs100_power_12h_avg
                name: 12h avg
              - entity: sensor.pbs100_daily_cost
                name: Cost Daily
              - entity: sensor.pbs100_monthly_cost
                name: Monthly

          - type: glance
            columns: 6
            state_color: true
            entities:
              # NVME 0
              - entity: sensor.pbs100_sda_tb_written
                name: 870Evo Tot W
                icon: mdi:raspberry-pi
              - entity: sensor.pbs100_sda_session_read
                name: R Session
              - entity: sensor.pbs100_sda_session_write
                name: W Session
              - entity: sensor.pbs100_sda_write_change_1h
                name: W\h
              - entity: sensor.pbs100_sda_life_left_smart
                name: "%"
              - entity: sensor.pbs100_sda_temp
                name: T

          - type: glance
            columns: 6
            state_color: true
            entities:
              # NVME 0
              - entity: sensor.pbs100_nvme0_tb_written
                name: PM9A1 Tot W
                icon: mdi:raspberry-pi
              - entity: sensor.pbs100_nvme0_session_read
                name: R Session
              - entity: sensor.pbs100_nvme0_session_write
                name: W Session
              - entity: sensor.pbs100_nvme0_write_change_1h
                name: W\h
              - entity: sensor.pbs100_nvme0_life_left_smart
                name: "%"
              - entity: sensor.pbs100_nvme0_temp
                name: T

          - type: glance
            columns: 2
            state_color: true
            entities:
              - entity: sensor.pbs100_enp1s0_speed
                name: port1
              - entity: sensor.pbs100_enp3s0_speed
                name: port2

          - type: glance
            columns: 2
            state_color: true
            entities:
              - entity: sensor.pikvm_2w_cpu_load
                name: PiKVM 2w CPU
              - entity: sensor.pikvm_2w_cpu_temp
                name: CPUT

      - type: vertical-stack
        title: Aux
        cards:
          - type: glance
            columns: 3
            entities:
              - entity: sensor.sonoff_pow_r2_3_power
                name: W
              - entity: sensor.sonoff_pow_r2_3_voltage
                name: V
              - entity: sensor.sonoff_pow_r2_3_current
                name: A
          - type: history-graph
            hours_to_show: 24
            entities:
              - entity: sensor.0x00158d000233fb72_temperature
                name: Aux St
              - entity: sensor.a4c13819b4ad_temperature
                name: Rack St
              - entity: sensor.a4c138f0a65b_temperature
                name: Wall St

          - type: history-graph
            hours_to_show: 24
            entities:
              - entity: sensor.0x00158d000233fb72_humidity
                name: Aux St
              - entity: sensor.a4c13819b4ad_humidity
                name: Rack St
              - entity: sensor.a4c138f0a65b_humidity
                name: Wall St

          - type: entities
            entities:
              - switch.ds920_wol

          # - type: glance
          #   columns: 4
          #   entities:
          #     - entity: sensor.esp32_node_st_dallas_1
          #       name: AUX St
          #     - entity: sensor.esp32_node_st_dallas_2
          #       name: 1621 St
          #     - entity: sensor.esp32_node_st_dallas_3
          #       name: AggrSw St
          #     - entity: sensor.esp32_node_st_dallas_4
          #       name: Backwall St
          # - type: history-graph
          #   hours_to_show: 24
          #   entities:
          #     - entity: sensor.esp32_node_st_dallas_1
          #       name: AUX St
          #     - entity: sensor.esp32_node_st_dallas_2
          #       name: 1621 St
          #     - entity: sensor.esp32_node_st_dallas_3
          #       name: AggrSw St
          #     - entity: sensor.esp32_node_st_dallas_4
          #       name: Backwall St
  ################################################################
  # radio
  ################################################################
  # - title: Radio
  #   icon: mdi:radio
  #   cards:
  #     - type: vertical-stack
  #       cards:
  #         - type: custom:stack-in-card
  #           mode: vertical
  #           cards:
  #             - type: entities
  #               state_color: true
  #               entities:
  #                 #- group.my_radio
  #                 - input_select.radio_station
  #                 - input_select.chromecast_radio
  #                 - input_number.volume_radio
  #             - type: horizontal-stack
  #               cards:
  #                 - type: entity-button
  #                   name: Play
  #                   icon: mdi:play
  #                   entity: script.radio_on
  #                   hold_action: none
  #                   tap_action:
  #                     action: call-service
  #                     service: script.radio_on
  #                 - type: entity-button
  #                   name: Stop
  #                   icon: mdi:stop
  #                   entity: script.radio_off
  #                   hold_action: none
  #                   tap_action:
  #                     action: call-service
  #                     service: script.radio_off
  #         - type: glance
  #           columns: 5
  #           state_color: true
  #           entities:
  #             - entity: media_player.yandex_v #home_mini_v
  #               name: V
  #             - entity: media_player.yandex_s #home_mini_s
  #               name: S
  #             - entity: media_player.yandex_k #home_mini_k
  #               name: K
  #             - entity: media_player.yandex_mb #home_mini_mb
  #               name: MB
  #             - entity: media_player.yandex_hb #home_mini_hb
  #               name: HB
  #             # - entity: media_player.mpd
  #             #   name: MPD

  ################################################################
  # Weather monitoring
  ################################################################
  - title: Weather
    icon: mdi:weather-cloudy
    cards:
      - type: vertical-stack
        cards:
          - type: glance
            entities:
              - sensor.dewpoint
              - sensor.heatindex
              - sensor.windchill
              - sensor.feelslike
          - type: entities
            state_color: true
            entities:
              - sensor.pressure_weather_forecast
          # - type: history-graph
          #   hours_to_show: 48
          #   entities:
          #     - sensor.magnetic_storm
          - type: glance
            columns: 6
            state_color: true
            entities:
              - entity: binary_sensor.pressure_rising_fast
                name: U Fast
              - entity: binary_sensor.pressure_rising_slow
                name: U Slow
              - entity: binary_sensor.pressure_falling_fast
                name: D Fast
              - entity: binary_sensor.pressure_falling_slow
                name: D Slow
              - entity: binary_sensor.temp_rising
                name: T Up
              - entity: binary_sensor.temp_falling
                name: T Down
          - type: history-graph
            hours_to_show: 48
            entities:
              - entity: sensor.pressure_change_3h
                name: 3h
              - entity: sensor.pressure_change_6h
                name: 6h
          - type: history-graph
            hours_to_show: 48
            entities:
              - entity: sensor.0x00158d000233fb72_pressure
                name: St
              # - entity: sensor.sonoff_basic_1_bme280_pressure
              #   name: BME St
              - entity: sensor.esp32_node_k_pressure
                name: K
              - entity: sensor.esp32_node_mb_pressure
                name: MB
              - entity: sensor.esp32_node_v_pressure
                name: V
              - entity: sensor.sonoff_pow_r2_2_pressure
                name: T
              - entity: sensor.pressure_average
                name: Avg

      - type: vertical-stack
        cards:
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.sunlight_pct
              - sensor.pirateweather_cloud_coverage

          - type: gauge
            name: Gradient
            entity: sensor.pressure_gradient
            max: 500
            min: -500
            severity:
              blue: -500
              green: 0
              yellow: 500
          - type: custom:mini-graph-card
            entities:
              - sensor.pressure_gradient
            hours_to_show: 48
            points_per_hour: 10
            decimals: 0
            hour24: true
            extrema: true
            labels: true
            line_width: 1
            line_color: blue
            upper_bound: 500
            lower_bound: -500

          - type: history-graph
            hours_to_show: 24
            entities:
              - sensor.pressure_gradient

      - type: vertical-stack
        cards:
          # - type: history-graph
          #   hours_to_show: 48
          #   entities:
          #     - entity: sensor.waqi_pm25
          #       name: PM25
          #     - entity: sensor.waqi_co_level
          #       name: CO
          #     - entity: sensor.waqi_o3_level
          #       name: O3
          #     - entity: sensor.waqi_no2_level
          #       name: NO2
          #     - entity: sensor.waqi_so2_level
          #       name: SO2

          - type: custom:sun-card
            showAzimuth: true
            showElevation: true
            timeFormat: "24h"

  ################################################################
  # ESP States
  ################################################################
  - title: ESPs
    icon: mdi:car-esp
    cards:
      - type: entities
        title: ESPs State
        show_header_toggle: false
        state_color: true
        entities:
          - binary_sensor.sonoff_pow_r2_2_status
          - binary_sensor.esp32_node_b_status
          - binary_sensor.sonoff_pow_r2_1_status
          - binary_sensor.esp32_node_hs_status
          - binary_sensor.mono_strip_1_status
          # - binary_sensor.shp2_socket_1_status
          # - binary_sensor.shp6_socket_1_status
          # - binary_sensor.shp6_socket_2_status
          - binary_sensor.d1mini_air_freshener_status
          - binary_sensor.d1mini_distance_sensor_status
          #- binary_sensor.esp32_ble_hs_status

          - type: divider
          #- binary_sensor.esp01_weight_pad_status
          - binary_sensor.esp32_node_k_status
          #- binary_sensor.ss5_hood_status
          - binary_sensor.esp8266_hood_k_status
          - binary_sensor.esp8266_oven_temp_k_status
          - binary_sensor.sonoff_mini_4_status
          - binary_sensor.d1mini_light_l_status

          - type: divider
          - binary_sensor.esp32_node_v_status
          - binary_sensor.d1mini_bed_leds_status
          #- binary_sensor.sonoff_basic_4_status
          - binary_sensor.digma_ir_v_status

          - type: divider
          - binary_sensor.esp32_pzem_hb_status
          #- binary_sensor.shp2_socket_server_status
          #- binary_sensor.esp32_ble_hb_status
          #- binary_sensor.esp32_domofon_status
          - binary_sensor.esp32_domofon_status
          - binary_sensor.sonoff_mini_r4_kiosk_charger_status
          #- binary_sensor.esp32_domofon_status
          - binary_sensor.sonoff_mini_1_status
          #- binary_sensor.sonoff_basic_1_status
          - binary_sensor.digma_strip_hb_status
          - binary_sensor.esp32_strip_1s_entrance_hb_status
          - binary_sensor.esp32_strip_1s_wadrobe_hb_status

          - type: divider
          - binary_sensor.esp32_node_mb_status
          - binary_sensor.digma_ir_mb_status
          #- binary_sensor.sonoff_basic_3_status
          #- binary_sensor.shp2_socket_2_status
          - binary_sensor.esp32_strip_1s_wadrobe_mb_status
          - binary_sensor.esp32_strip_1s_bookshelf_mb_status
          #- binary_sensor.esp32_ble_mb_status

          - type: divider
          - binary_sensor.esp32_node_s_status
          - binary_sensor.digma_ir_s_status
          - binary_sensor.sp111_socket_1_status
          #- binary_sensor.s26_socket_1_status
          - binary_sensor.sonoff_basic_4_status
          #- binary_sensor.avatto_socket_1_status
          #- binary_sensor.esp32_ble_s_status
          - type: divider
          - binary_sensor.sonoff_pow_r2_3_status
          #- binary_sensor.esp32_node_st_status

      - type: entities
        title: RSSI
        show_header_toggle: false
        state_color: true
        entities:
          - sensor.sonoff_pow_r2_2_wifi_rssi
          - sensor.esp32_node_b_wifi_rssi
          - sensor.sonoff_pow_r2_1_wifi_rssi
          - sensor.esp32_node_hs_wifi_rssi
          - sensor.mono_strip_1_wifi_rssi
          # - sensor.shp2_socket_1_wifi_rssi
          # - sensor.shp6_socket_1_wifi_rssi
          # - sensor.shp6_socket_2_wifi_rssi
          - sensor.d1mini_air_freshener_wifi_rssi
          - sensor.d1mini_distance_sensor_wifi_rssi
          #- sensor.esp32_ble_hs_wifi_rssi

          - type: divider
          #- sensor.esp01_weight_pad_wifi_rssi
          - sensor.esp32_node_k_wifi_rssi
          #- sensor.ss5_hood_wifi_rssi
          - sensor.esp8266_hood_k_wifi_rssi
          - sensor.esp8266_oven_temp_k_wifi_rssi
          - sensor.sonoff_mini_4_wifi_rssi
          - sensor.d1mini_light_l_wifi_rssi

          - type: divider
          - sensor.esp32_node_v_wifi_rssi
          - sensor.d1mini_bed_leds_wifi_rssi
          #- sensor.sonoff_basic_4_wifi_rssi
          - sensor.digma_ir_v_wifi_rssi

          - type: divider
          - sensor.esp32_pzem_hb_wifi_rssi
          #- sensor.shp2_socket_server_wifi_rssi
          #- sensor.esp32_ble_hb_wifi_rssi
          #- sensor.esp32_domofon_wifi_rssi
          - sensor.esp32_domofon_wifi_rssi
          - sensor.sonoff_mini_r4_kiosk_charger_wifi_rssi
          #- sensor.esp32_domofon_wifi_rssi
          - sensor.sonoff_mini_1_wifi_rssi
          #- sensor.sonoff_basic_1_wifi_rssi
          - sensor.digma_strip_hb_wifi_rssi
          - sensor.esp32_strip_1s_entrance_hb_wifi_rssi
          - sensor.esp32_strip_1s_wadrobe_hb_wifi_rssi

          - type: divider
          - sensor.esp32_node_mb_wifi_rssi
          - sensor.digma_ir_mb_wifi_rssi
          #- sensor.sonoff_basic_3_wifi_rssi
          #- sensor.shp2_socket_2_wifi_rssi
          - sensor.esp32_strip_1s_wadrobe_mb_wifi_rssi
          - sensor.esp32_strip_1s_bookshelf_mb_wifi_rssi
          #- sensor.esp32_ble_mb_wifi_rssi

          - type: divider
          - sensor.esp32_node_s_wifi_rssi
          - sensor.digma_ir_s_wifi_rssi
          - sensor.sp111_socket_1_wifi_rssi
          #- sensor.s26_socket_1_wifi_rssi
          - sensor.sonoff_basic_4_wifi_rssi
          #- sensor.avatto_socket_1_wifi_rssi
          #- sensor.esp32_ble_s_wifi_rssi

          - type: divider
          - sensor.sonoff_pow_r2_3_wifi_rssi
          #- sensor.esp32_node_st_wifi_rssi

      - type: entities
        title: Uptime
        show_header_toggle: false
        state_color: true
        entities:
          - sensor.sonoff_pow_r2_2_uptime
          - sensor.esp32_node_b_uptime
          - sensor.sonoff_pow_r2_1_uptime
          - sensor.esp32_node_hs_uptime
          - sensor.mono_strip_1_uptime
          # - sensor.shp2_socket_1_uptime
          # - sensor.shp6_socket_1_uptime
          # - sensor.shp6_socket_2_uptime
          - sensor.d1mini_air_freshener_uptime
          - sensor.d1mini_distance_sensor_uptime
          #- sensor.esp32_ble_hs_uptime

          - type: divider
          #- sensor.esp01_weight_pad_uptime
          - sensor.esp32_node_k_uptime
          #- sensor.ss5_hood_uptime
          - sensor.esp8266_hood_k_uptime
          - sensor.esp8266_oven_temp_k_uptime
          - sensor.sonoff_mini_4_uptime
          - sensor.d1mini_light_l_uptime

          - type: divider
          - sensor.esp32_node_v_uptime
          - sensor.d1mini_bed_leds_uptime
          #- sensor.sonoff_basic_4_uptime
          - sensor.digma_ir_v_uptime

          - type: divider
          - sensor.esp32_pzem_hb_uptime
          #- sensor.shp2_socket_server_uptime
          #- sensor.esp32_ble_hb_uptime
          #- sensor.esp32_domofon_uptime
          - sensor.esp32_domofon_uptime
          - sensor.sonoff_mini_r4_kiosk_charger_uptime
          #- sensor.esp32_domofon_uptime
          - sensor.sonoff_mini_1_uptime
          #- sensor.sonoff_basic_1_uptime
          - sensor.digma_strip_hb_uptime
          - sensor.esp32_strip_1s_entrance_hb_uptime
          - sensor.esp32_strip_1s_wadrobe_hb_uptime

          - type: divider
          - sensor.esp32_node_mb_uptime
          - sensor.digma_ir_mb_uptime
          #- sensor.sonoff_basic_3_uptime
          #- sensor.shp2_socket_2_uptime
          - sensor.esp32_strip_1s_wadrobe_mb_uptime
          - sensor.esp32_strip_1s_bookshelf_mb_uptime
          #- sensor.esp32_ble_mb_uptime

          - type: divider
          - sensor.esp32_node_s_uptime
          - sensor.digma_ir_s_uptime
          - sensor.sp111_socket_1_uptime
          #- sensor.s26_socket_1_uptime
          - sensor.sonoff_basic_4_uptime
          #- sensor.avatto_socket_1_uptime
          #- sensor.esp32_ble_s_uptime

          - type: divider
          - sensor.sonoff_pow_r2_3_uptime
          #- sensor.esp32_node_st_uptime

  ################################################################
  # Lamps Reset
  ################################################################
  - title: WiFi Devices Restart Control
    icon: mdi:wifi-strength-2-alert #mdi:lightbulb-off #mdi:file-settings-variant
    cards:
      - type: vertical-stack
        cards:
          - type: entities
            title: Statuses
            show_header_toggle: false
            state_color: true
            entities:
              - light.round_led_mb
              - type: divider
              - light.square_led_s
              - type: divider
              - light.round_led_k
              - type: divider
              - light.round_led_hs
              - type: divider
              - light.square_led_v
              - type: divider
              - light.d1mini_bed_leds_strip_dima
              - type: divider
              - light.light_bar_s
              - type: divider
              - light.mirror_light_b
              - type: divider
              - light.esp32_strip_1s_wadrobe_hb_rgb
              - type: divider
              - light.esp32_strip_1s_entrance_hb_rgb
              - type: divider
              - light.bedside
              - type: divider
              - light.round_led_st
              - type: divider
              - light.0x54ef441000d4e7fd_light
              - type: divider
              #- light.led_color_s
              #- type: divider
              - light.0x54ef441000c88fa8_light
              - type: divider
              - light.0x54ef441000d54c6c_light
              - type: divider
              - fan.purifier2s

      - type: vertical-stack
        cards:
          - type: entities
            title: Switches
            show_header_toggle: false
            state_color: true
            entities:
              - switch.shelly_1_led_mb
              - type: divider
              - switch.shelly_1_led_s
              - type: divider
              - switch.0x00158d0002a36f7f_channel_2
              - type: divider
              - switch.0x00158d0002a36433_channel_1
              - type: divider
              - switch.shelly_1pm_led_v
              - type: divider
              - switch.0x00158d0001a248e3_channel_1
              - type: divider
              - switch.sp111_socket_1_relay
              - type: divider
              - switch.esp32_node_b_relay_5
              - type: divider
              - switch.0x00158d00023e5812_outlet
              - type: divider
              - switch.digma_strip_hb_relay1
              - type: divider
              - switch.0x00158d00039bd56d_plug
              - type: divider
              - switch.sonoff_basic_2_relay
              # - type: divider
              # - switch.0x00158d00023a657a_plug
              # - type: divider
              # - switch.0x158d000205a835_switch
      - type: vertical-stack
        cards:
          - type: entities
            title: Scripts
            show_header_toggle: false
            state_color: true
            entities:
              - script.round_led_mb_restart
              - type: divider
              - script.square_led_s_restart
              - type: divider
              - script.round_led_k_restart
              - type: divider
              - script.round_led_hs_restart
              - type: divider
              - script.square_led_v_restart
              - type: divider
              - script.led_strip_bed_dima_v_restart
              - type: divider
              - script.light_bar_s_restart
              - type: divider
              - script.mirror_light_b_restart
              - type: divider
              - script.led_strip_hb_restart
              - type: divider
              - script.led_strip_entrance_hb_restart
              - type: divider
              - script.bedside_restart
              - type: divider
              # - script.led_color_v_restart
              # - type: divider
              - script.round_led_st_restart
              # - type: divider
              # - script.led_color_mb_restart

  ################################################################
  # z2m
  ################################################################
  # - title: z2m
  #   icon: mdi:zigbee
  #   cards:
  #     - type: vertical-stack
  #       cards:
  #         - type: entities
  #           title: Zigbee2mqtt
  #           show_header_toggle: false
  #           entities:
  #             - entity: sensor.zigbee2mqtt_bridge_state
  #             - entity: sensor.zigbee2mqtt_permit_join
  #             - entity: sensor.zigbee2mqtt_version
  #             - entity: sensor.zigbee2mqtt_coordinator_version
  #             - entity: sensor.zigbee2mqtt_network_channel
  #             - entity: sensor.zigbee2mqtt_network_panid
  #             - entity: sensor.zigbee2mqtt_network_extended_panid
  #             - type: divider
  #             - entity: input_text.zigbee2mqtt_map_rebuild
  #             - entity: sensor.zigbee2mqtt_last_message
  #             - entity: input_select.zigbee2mqtt_log_level
  #             - type: divider
  #             - entity: script.zigbee2mqtt_permit_join
  #             - entity: switch.zigbee2mqtt_main_join
  #             - entity: timer.zigbee2mqtt_permit_join
  #             - type: divider
  #             - entity: script.zigbee2mqtt_linkuality_check
  #             - entity: script.zigbee2mqtt_lastseen_check
  #             - entity: script.zigbee2mqtt_map_rebuild
  #             - type: divider
  #             - sensor.zigbee2mqtt_addon_restart
  #             - entity: script.zigbee2mqtt_restart

  #     - type: custom:stack-in-card
  #       mode: vertical
  #       cards:
  #         - type: glance
  #           entities:
  #             - entity: binary_sensor.esp32_ble_tracker_green
  #               name: green
  #             - entity: binary_sensor.esp32_ble_tracker_pink
  #               name: pink
  #             - entity: binary_sensor.esp32_ble_tracker_grey
  #               name: grey
  #             - entity: binary_sensor.esp32_ble_tracker_white
  #               name: white

  # - title: Kiosk
  #   icon: mdi:camera

  #   cards:
  #     - type: picture-entity
  #       camera_view: live
  #       aspect_ratio: '16x9'
  #       entity: camera.door_hb
  #       show_name: false
  #       show_state: false

  - title: Temperature
    icon: mdi:home-thermometer-outline
    cards:
      - type: vertical-stack
        cards:
          # S
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0001e6d85a_temperature
          # V
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0001e58714_temperature
              - sensor.esp32_node_v_temperature
              - sensor.582d34530ee0_temperature
          # MB
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d000222c746_temperature
              - sensor.esp32_node_mb_temperature
          # Out
          - type: history-graph
            hours_to_show: 24
            entities:
              - sensor.temperature_outside
      - type: vertical-stack
        cards:
          # HB
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0002464ec0_temperature
          # K
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0001e586af_temperature
              - sensor.esp32_node_k_temperature
          # B
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d00020d7c3a_temperature
              - sensor.e72e0120fcdc_temperature
              - sensor.esp32_node_b_temperature
          # T
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0001e58754_temperature
              - sensor.e72e00d2911f_temperature
              - sensor.sonoff_pow_r2_2_temperature
      - type: vertical-stack
        cards:
          # St
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d000233fb72_temperature
          # Fridge
          - type: history-graph
            hours_to_show: 48
            entities:
              - entity: sensor.ble_temperature_ble_fridge
                name: BLE Fridge
              - entity: sensor.a4c1385224b4_temperature
                name: Mi Fridge
          # Frezer
          - type: history-graph
            hours_to_show: 48
            entities:
              - entity: sensor.ble_temperature_ble_freezer
                name: BLE Freezer
              - entity: sensor.a4c13898814f_temperature
                name: Mi Freezer
          # Hood
          - type: history-graph
            hours_to_show: 24
            entities:
              - entity: sensor.esp8266_hood_k_tcouple
                name: K
              - entity: sensor.stove_temperature_median
                name: Median
              - entity: sensor.esp8266_hood_k_median_ha
                name: Med+5
          # Oven
          - type: history-graph
            hours_to_show: 24
            entities:
              - entity: sensor.oven_target_temperature
                name: Target
              - entity: sensor.esp8266_oven_temp_k_temperature
                name: Oven

  - title: Humidity
    icon: mdi:water-percent
    cards:
      - type: vertical-stack
        cards:
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0001e6d85a_humidity
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0001e58714_humidity
              - sensor.esp32_node_v_humidity
              - sensor.582d34530ee0_humidity
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d000222c746_humidity
              - sensor.esp32_node_mb_humidity
          # - type: history-graph
          #   hours_to_show: 24
          #   entities:
          #     - sensor.0x158d000239ad5b_humidity
      - type: vertical-stack
        cards:
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0002464ec0_humidity
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0001e586af_humidity
              - sensor.esp32_node_k_humidity
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d00020d7c3a_humidity
              - sensor.e72e0120fcdc_humidity
              - sensor.esp32_node_b_humidity
              #- sensor.a4c138f0a65b_humidity

          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d0001e58754_humidity
              - sensor.e72e00d2911f_humidity
              - sensor.sonoff_pow_r2_2_humidity
      - type: vertical-stack
        cards:
          - type: history-graph
            hours_to_show: 48
            entities:
              - sensor.0x00158d000233fb72_humidity
              #- sensor.sonoff_basic_1_bme280_humidity
          - type: history-graph
            hours_to_show: 48
            entities:
              - entity: sensor.ble_humidity_ble_fridge
                name: BLE Fridge
              - entity: sensor.a4c1385224b4_humidity
                name: Mi Fridge
          - type: history-graph
            hours_to_show: 48
            entities:
              - entity: sensor.ble_humidity_ble_freezer
                name: BLE Freezer
              - entity: sensor.a4c13898814f_humidity
                name: Mi Freezer

  - title: All GW3 Switches
    icon: mdi:electric-switch
    cards:
      - type: entities
        show_header_toggle: false
        state_color: true
        entities:
          - entity: switch.0x00158d0001e85086_plug
            secondary_info: last-changed
          - entity: switch.0x00158d0001f2630e_outlet
            secondary_info: last-changed
          # - entity: switch.0x158d000205a835_switch
          #   secondary_info: last-changed
          - entity: light.0x00158d000223921b_channel_1
            secondary_info: last-changed
          - entity: switch.0x00158d000223921b_channel_2
            secondary_info: last-changed
          - entity: switch.0x00158d000230fc52_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d000239097a_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d0002395d58_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d0002395dc9_outlet
            secondary_info: last-changed
          # - entity: switch.0x00158d00023a657a_plug
          #   secondary_info: last-changed
          - entity: switch.0x00158d00023e5812_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d00024517fe_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d0002451850_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d000246776f_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d0002467773_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d000322e1d9_plug
            secondary_info: last-changed
          - entity: switch.0x00158d0002476ed1_outlet
            secondary_info: last-changed
      - type: entities
        show_header_toggle: false
        state_color: true
        entities:
          - entity: switch.0x00158d000249b25b_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d000249b26b_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d000253f04a_channel_1
            secondary_info: last-changed
          - entity: light.0x00158d000253f04a_channel_2
            secondary_info: last-changed
          - entity: switch.0x00158d00028a54e4_plug
            secondary_info: last-changed
          - entity: switch.0x00158d00028b4fc3_plug
            secondary_info: last-changed
          - entity: switch.0x00158d00028c9875_plug
            secondary_info: last-changed
          - entity: switch.0x00158d000290a093_plug
            secondary_info: last-changed
          - entity: switch.0x00158d000290a0bc_plug
            secondary_info: last-changed
          - entity: switch.0x00158d0002924790_plug
            secondary_info: last-changed
          - entity: switch.0x00158d0002a36433_channel_1
            secondary_info: last-changed
          - entity: light.0x00158d0002a36433_channel_2
            secondary_info: last-changed
          # - entity: light.round_led_st
          #   secondary_info: last-changed
          - entity: light.0x54ef441000680083_channel_2
            secondary_info: last-changed
          # - entity: switch.0x158d000366815b_channel_1
          #   secondary_info: last-changed
          # - entity: switch.0x158d000366815d_channel_2
          #   secondary_info: last-changed

      - type: entities
        show_header_toggle: false
        state_color: true
        entities:
          - entity: light.0x00158d0002a36f7f_channel_1
            secondary_info: last-changed
          - entity: switch.0x00158d0002a36f7f_channel_2
            secondary_info: last-changed
          # - entity: switch.0x158d000322e1d9_switch
          #   secondary_info: last-changed
          - entity: switch.0x00158d000322e30c_plug
            secondary_info: last-changed
          - entity: switch.0x00158d000344998e_plug
            secondary_info: last-changed
          - entity: switch.0x00158d000345119e_plug
            secondary_info: last-changed
          - entity: switch.0x00158d0003535ee5_plug
            secondary_info: last-changed
          - entity: switch.0x00158d0003539447_plug
            secondary_info: last-changed
          - entity: switch.0x00158d000353a2e3_plug
            secondary_info: last-changed
          - entity: switch.0x00158d0001f26071_outlet
            secondary_info: last-changed
          - entity: switch.0x00158d00035c194f_plug
            secondary_info: last-changed
          #- entity: switch.0x00158d00035f44a7_plug
          #  secondary_info: last-changed
          - entity: switch.0x00158d0003600ea4_plug
            secondary_info: last-changed
          - entity: switch.0x00158d00036148b9_plug
            secondary_info: last-changed
          - entity: switch.0x00158d00039258de_plug
            secondary_info: last-changed
          - entity: switch.0x00158d000392623d_plug
            secondary_info: last-changed
          # - entity: switch.0x00158d00039bd56d_plug
          #   secondary_info: last-changed
          - entity: switch.0x00158d000224e3e4_outlet
            secondary_info: last-changed
  - title: All GW3 Sensors
    icon: mdi:radiobox-marked
    cards:
      - type: entities
        state_color: true
        entities:
          - entity: binary_sensor.0x00158d0002a1a4b2_contact
            name: Bottom Lock Sensor
            secondary_info: last-changed
          - entity: binary_sensor.bottom_lock
            name: Bottom Lock Template
            secondary_info: last-changed
          - type: divider
          - entity: binary_sensor.0x00158d0002b7c2c8_contact
            name: Top lock Sensor
            secondary_info: last-changed
          - entity: binary_sensor.top_lock
            name: Top Lock Template
            secondary_info: last-changed
      - type: entities
        state_color: true
        #columns: 7
        entities:
          - entity: binary_sensor.0x00158d0001d5995e_motion
            name: HB - Mid Dooor
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001e05856_motion
            name: HB - Entrance
            secondary_info: last-changed
          - entity: binary_sensor.582d3460dc57_motion
            name: B - Tub BT
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b482e9_motion
            name: HB - Fridge
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000224f89f_motion
            name: S - Entrance
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0003140824_motion
            name: S - Window
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001ae9f61_motion
            name: HS - Near
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b43ad4_motion
            name: HS - Far
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001aea602_motion
            name: St - Top
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0003f27ce2_motion
            name: St - Side
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001e53cda_motion
            name: MB
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001e54280_motion
            name: T
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000236bb94_motion
            name: V
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00053faae1_motion
            name: V - Bed Dima
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00044c7971_motion
            name: V - Bed Sandra
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000236bc6d_motion
            name: B - Entrance
            secondary_info: last-changed
          - entity: binary_sensor.582d34609600_motion
            name: HB - BT
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b4729d_motion
            name: K - Main
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b48381_motion
            name: K - Entrance
            secondary_info: last-changed
          - entity: binary_sensor.50ec50cd0062_motion
            name: K - Night Light
            secondary_info: last-changed
      - type: entities
        show_header_toggle: false
        state_color: true
        entities:
          - entity: binary_sensor.0x00158d0001e5d6be_contact
            secondary_info: last-changed
          - entity: binary_sensor.582d344031f7_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0001ef2ffc_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000200ad58_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0003fa6cf5_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00023297e7_moisture
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000232ddd6_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0006d31d78_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00023684c2_moisture
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000236fcd5_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000236fdc9_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002373a67_moisture
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002349f5b_moisture
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00024bcf85_gas
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002529b9c_contact
            secondary_info: last-changed
      - type: entities
        show_header_toggle: false
        state_color: true
        entities:
          - entity: binary_sensor.0x00158d000252acba_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00025315e9_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002531749_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00025370d1_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00025371f6_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d000253722b_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d00027129ae_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002a14c5e_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002a1a47a_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002a1a4b2_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002b7c2c8_contact
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0002c92f31_smoke
            secondary_info: last-changed
          - entity: binary_sensor.a4c138833042_contact
            secondary_info: last-changed
          # - entity: binary_sensor.0x158d00035c6905_contact
          #   secondary_info: last-changed
          # - entity: binary_sensor.0x00158d000423f316_contact
          #   secondary_info: last-changed

  - title: Radio Quality [GW 3]
    path: gw3
    icon: mdi:radio-tower
    panel: true
    cards:
      - type: vertical-stack
        cards:
          # Gateways
          - type: markdown
            content: "### <center> Gateways </center>"
          - type: "custom:flex-table-card"
            clickable: false
            entities:
              include:
                - binary_sensor.*_gateway
              exclude:
                - binary_sensor.ble_gateway
                #- binary_sensor.sls_gateway_state
            sort_by: friendly_name
            columns:
              - data: friendly_name
                name: Friendly Name
                modify: '(x+"").replace(/ Gateway$/,"")'
              - data: network_pan_id
                name: Network PAN ID
                modify: 'x == "" ? "-" : x+""'
                align: center
              - data: gateway.firmware
                name: FW
                align: center
              - data: radio_tx_power
                name: Radio TX Power
                modify: 'isNaN(parseInt(x, 10)) ? "-" : parseInt(x, 10)'
                align: center
              - data: radio_channel
                name: Radio Channel
                modify: 'isNaN(parseInt(x, 10)) ? "-" : parseInt(x, 10)'
                align: center
              - data: free_mem
                name: Memory Free (KB)
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              - data: load_avg
                name: Load Avg (1m, 5m, 15m)
                modify: '(x+"").split("|").slice(0, 3).join(", ")'
                align: center
              - data: serial
                name: ZB Tx
                modify: "isNaN(parseInt(x.zigbee_tx, 10)) ? 0 : parseInt(x.zigbee_tx, 10)"
                align: center
              - data: serial
                name: ZB Rx
                modify: "isNaN(parseInt(x.zigbee_rx, 10)) ? 0 : parseInt(x.zigbee_rx, 10)"
                align: center
              - data: serial
                name: ZB Err
                modify: "isNaN(parseInt(x.zigbee_oe, 10)) ? 0 : parseInt(x.zigbee_oe, 10)"
                align: center
              - data: serial
                name: BT Tx
                modify: "isNaN(parseInt(x.bluetooth_tx, 10)) ? 0 : parseInt(x.bluetooth_tx, 10)"
                align: center
              - data: serial
                name: BT Rx
                modify: "isNaN(parseInt(x.bluetooth_rx, 10)) ? 0 : parseInt(x.bluetooth_rx, 10)"
                align: center
              - data: serial
                name: BT Err
                modify: "isNaN(parseInt(x.bluetooth_oe, 10)) ? 0 : parseInt(x.bluetooth_oe, 10)"
                align: center
              # - data: rssi
              #   name: RSSI
              - data: uptime
                name: Gateway Uptime
                modify: x+''
                align: center
              - data: last_changed
                name: Connected Since
                modify: >
                  var dt = new Date(x);
                  var hrs = parseInt((Date.now()-Date.parse(x)) / 3600000);
                  var min = parseInt(((Date.now()-Date.parse(x)) / 60000) % 60);
                  var sec = parseInt(((Date.now()-Date.parse(x)) / 1000) % 60);
                  hrs = (hrs < 10) ? "0" + hrs : hrs;
                  min = (min < 10) ? "0" + min : min;
                  sec = (sec < 10) ? "0" + sec : sec;
                  isFinite(dt) ? dt.toLocaleString(['ru-RU', 'en-US']) +
                  " (Up: " + hrs + ":" + min + ":" + sec + ")" : ""
                align: center
            css:
              table+: "padding-top: 15px;"
              "tbody tr:nth-child(even)": "background-color: #a2542f6;"
              td.left: "padding: 10px 10px 10px 10px"
              th.left: "padding: 0px 0px 10px 10px"
          # ZigBee
          - type: markdown
            content: "### <center> ZigBee </center>"
          - type: "custom:flex-table-card"
            clickable: false
            entities:
              include:
                - sensor.*_zigbee
            sort_by: state- #ieee
            columns:
              - data: friendly_name
                name: Friendly Name
                modify: 'x.replace(/ Zigbee$/,"")'
              - data: gate
                name: Gate
                modify: x+''
                align: center
              - data: device.extra.ieee
                name: IEEE
                modify: (x+'').toLowerCase()
                align: center
              - data: device.extra.nwk
                name: NWK
                modify: (x+'').replace(/^0x/,"")
                align: center
              - data: device.extra.nwk_parent
                name: Parent
                modify: 'x == "0x0000" ? "-" : (x+"").replace(/^0x/,"")'
                align: center
              - data: device.extra.hw_ver
                name: HW
                modify: 'x == "" ? "-" : x+""'
                align: center
              - data: device.extra.fw_ver
                name: FW
                modify: 'x == "" ? "-" : x+""'
                align: center
              - data: msg_received
                name: Received
                modify: "isNaN(parseInt(x, 10)) ? 0 : parseInt(x, 10)"
                align: center
              - data: msg_missed
                name: Missed
                modify: "isNaN(parseInt(x, 10)) ? 0 : parseInt(x, 10)"
                align: center
              - data: device.extra.new_resets
                name: Resets
                modify: "isNaN(parseInt(x, 10)) ? 0 : parseInt(x, 10)"
                align: center
              - data: device.extra.lqi
                name: LQI
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              - data: device.extra.rssi
                name: RSSI
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              # - data: last_msg
              #   name: Last Message
              #   modify: x+''
              #   align: center
              - data: device.available
                name: Available
                modify: 'x === true ? "‚úì" : x+""'
                align: center
              - data: state
                name: Last Seen
                modify: >
                  var min = Math.round((Date.now()-Date.parse(x))/60000);
                  isFinite(min) ? min : 65536
                align: center
            css:
              table+: "padding-top: 15px;"
              "tbody tr:nth-child(even)": "background-color: #a2542f6;"
              td.left: "padding: 10px 10px 10px 10px"
              th.left: "padding: 0px 0px 10px 10px"

          # Bluetooth
          - type: markdown
            content: "### <center> Bluetooth </center>"
          - type: "custom:flex-table-card"
            clickable: false
            entities:
              include:
                - sensor.*_ble
            sort_by: state-
            columns:
              - data: friendly_name
                name: Friendly Name
                modify: 'x.replace(/ Ble$/,"")'
              - data: device.extra.mac
                name: MAC
                align: center
                #modify: (x+'').replace(/(.{2}(?!$))/g,"$1:")
              - data: msg_received
                name: Received
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              - data: msg_missed
                name: Missed
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              - data: device.last_report_gw.name
                name: Last GW
                align: center
              - data: state
                name: Last Seen
                modify: >
                  var dt = new Date(0,0,0,0,0,0,(Date.now()-Date.parse(x)));
                  isFinite(dt) ? dt.toTimeString().split(" ")[0] : ""
                align: center
            css:
              table+: "padding-top: 15px;"
              "tbody tr:nth-child(even)": "background-color: #a2542f6;"
              td.left: "padding: 10px 10px 10px 10px"
              th.left: "padding: 0px 0px 10px 10px"

          # Mesh
          - type: markdown
            content: "### <center> Mesh </center>"
          - type: "custom:flex-table-card"
            clickable: false
            entities:
              include:
                - sensor.*_mesh
            sort_by: state-
            columns:
              - data: friendly_name
                name: Friendly Name
                modify: 'x.replace(/ Ble$/,"")'
              - data: device.extra.mac
                name: MAC
                align: center
                #modify: (x+'').replace(/(.{2}(?!$))/g,"$1:")
              - data: msg_received
                name: Received
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              - data: msg_missed
                name: Missed
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              - data: device.last_report_gw.name
                name: Last GW
                align: center
                modify: x+''
              - data: state
                name: Last Seen
                modify: >
                  var dt = new Date(0,0,0,0,0,0,(Date.now()-Date.parse(x)));
                  isFinite(dt) ? dt.toTimeString().split(" ")[0] : ""
                align: center
            css:
              table+: "padding-top: 15px;"
              "tbody tr:nth-child(even)": "background-color: #a2542f6;"
              td.left: "padding: 10px 10px 10px 10px"
              th.left: "padding: 0px 0px 10px 10px"

  - title: GW3 Devices List
    icon: mdi:video-input-antenna
    panel: true
    cards:
      - type: vertical-stack
        cards:
          - type: markdown
            #content: '<center> <ha-icon icon="mdi:zigbee"></ha-icon> </center>'
            content: "### <center> ZigBee </center>"
          - type: "custom:flex-table-card"
            #title: ZigBee
            clickable: false
            entities:
              include:
                - sensor.*_zigbee
            sort_by: nwk
            #max_rows: 20
            columns:
              - data: friendly_name
                name: Friendly Name
                modify: 'x.replace(/ Zigbee$/,"")'
              - data: gate
                name: Gate
                modify: x+''
                align: center
              - data: device.extra.ieee
                name: IEEE
                modify: (x+'').toLowerCase()
                align: center
              - data: device.extra.nwk
                name: NWK
                modify: (x+'').replace(/^0x/,"")
                align: center
              - data: device.extra.nwk_parent
                name: Parent
                modify: 'x == "0x0000" ? "-" : (x+"").replace(/^0x/,"")'
                align: center
              - data: device.extra.hw_ver
                name: HW
                modify: 'x == "" ? "-" : x+""'
                align: center
              - data: device.extra.fw_ver
                name: FW
                modify: 'x == "" ? "-" : x+""'
                align: center
              - data: msg_received
                name: Received
                modify: "isNaN(parseInt(x, 10)) ? 0 : parseInt(x, 10)"
                align: center
              - data: msg_missed
                name: Missed
                modify: "isNaN(parseInt(x, 10)) ? 0 : parseInt(x, 10)"
                align: center
              - data: device.extra.new_resets
                name: Resets
                modify: "isNaN(parseInt(x, 10)) ? 0 : parseInt(x, 10)"
                align: center
              - data: device.extra.lqi
                name: LQI
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              - data: device.extra.rssi
                name: RSSI
                modify: 'isNaN(parseInt(x, 10)) ? "" : parseInt(x, 10)'
                align: center
              # - data: last_msg
              #   name: Last Message
              #   modify: x+''
              #   align: center
              - data: device.available
                name: Available
                modify: 'x === true ? "‚úì" : x+""'
                align: center
              - data: state
                name: Last Seen
                modify: >
                  var min = Math.round((Date.now()-Date.parse(x))/60000);
                  isFinite(min) ? min : 65536
                align: center
            css:
              table+: "padding-top: 15px;"
              "tbody tr:nth-child(even)": "background-color: #a2542f6;"
              td.left: "padding: 10px 10px 10px 10px"
              th.left: "padding: 0px 0px 10px 10px"

  - title: Testing
    icon: mdi:alpha
    cards:
      - type: vertical-stack
        cards:
          - type: entities
            entities:
              - entity: sensor.plex_12
                name: Plex Streams
              - entity: sensor.ms01b_cpu_temp
                name: ms01b CPU T
              - entity: sensor.ms01b_cpu_temp_10m
                name: ms01b CPU T 10min
              - entity: sensor.ms01b_cpu_load_10m
                name: ms01b CPU Load 10min
              - entity: sensor.lxc_lxc_plex12_303_cpu_used
                name: LXC Plex CPU Usage
              - entity: sensor.lxc_lxc_plex12_303_memory_used_percentage
                name: LXC Plex Mem Usage
              - entity: button.lxc_lxc_plex12_303_reboot
                name: LXC Restart
          - type: entities
            entities:
              - entity: binary_sensor.googlevideo_com
                name: googlevideo ping
              - entity: sensor.1621_go2rtc_active_streams
                name: "1621 go2rtc streams"
              - entity: sensor.main_go2rtc_active_streams
                name: "Main go2rtc streams"
              - entity: sensor.backup_go2rtc_active_streams
                name: "Backup go2rtc streams"
          - type: history-graph
            hours_to_show: 12
            entities:
              - entity: sensor.bathroom_humidity_derivative
                name: Mi
              - entity: sensor.bathroom_esp32_humidity_derivative
                name: ESP32
          - type: history-graph
            hours_to_show: 1
            entities:
              - entity: binary_sensor.0x00158d000236bc6d_motion
                name: Z M
              - entity: binary_sensor.582d3460dc57_motion
                name: B M
              - entity: binary_sensor.0x00158d0002a14c5e_contact
                name: D
              - entity: binary_sensor.wasp_b
                name: W
          - type: entities
            entities:
              - entity: binary_sensor.0x00158d000236bc6d_motion
                name: Z M
                secondary_info: last-changed
              - entity: binary_sensor.582d3460dc57_motion
                name: B M
                secondary_info: last-changed
              - entity: binary_sensor.0x00158d0002a14c5e_contact
                name: D
                secondary_info: last-changed
              - entity: binary_sensor.wasp_b
                name: W
                secondary_info: last-changed
          - type: entities
            entities:
              - input_boolean.bathroom_occupancy
              - light.esp32_node_hs_bathroom
      - type: history-graph
        hours_to_show: 6
        entities:
          - entity: sensor.a4c13880fdc1_temperature
            name: Dallas
          - entity: sensor.a4c13847af08_temperature
            name: MI
      - type: entities
        entities:
          - entity: binary_sensor.0x00158d0001aea602_motion
            name: Z
            secondary_info: last-changed
          - entity: binary_sensor.0x00158d0003f27ce2_motion
            name: Z2
            secondary_info: last-changed
          - entity: binary_sensor.54ef44c65722_motion
            name: BT MI
            secondary_info: last-changed
          - entity: binary_sensor.582d34609552_motion
            name: BT Qingping
            secondary_info: last-changed
      - type: entities
        entities:
          - sensor.ms01a_cpu_temp_10m
          - sensor.ms01a_cpu_load_10m
          - sensor.ms01b_cpu_temp_10m
          - sensor.ms01b_cpu_load_10m
      - type: entities
        entities:
          - switch.649e316fea46_switch
          - switch.649e31824801_switch
          - switch.649e316a3f6d_switch
      # - type: history-graph
      #   hours_to_show: 48
      #   entities:
      #     - entity: sensor.udr_price
      #       name: UDR
      #     # - entity: sensor.g5_flex_price
      #     #   name: G5
      - type: vertical-stack
        cards:
          - type: history-graph
            hours_to_show: 12
            entities:
              - entity: sensor.gateway3a_hb_free_memory
                name: HB
              - entity: sensor.gateway3a_hs_free_memory
                name: HS
              - entity: sensor.gateway3a_k_free_memory
                name: K
              - entity: sensor.gateway3a_mb_free_memory
                name: MB
              - entity: sensor.gateway3a_s_free_memory
                name: S
              - entity: sensor.gateway3a_v_free_memory
                name: V

          - type: entities
            entities:
              - sensor.gateway3a_hb_free_memory
              - sensor.gateway3a_hs_free_memory
              - sensor.gateway3a_k_free_memory
              - sensor.gateway3a_mb_free_memory
              - sensor.gateway3a_s_free_memory
              - sensor.gateway3a_v_free_memory
      - type: vertical-stack
        cards:
          # - type: glance
          #   entities:
          #     - sensor.treadmill_stats
          #     - binary_sensor.presence_b
          #     - binary_sensor.presence_t
          - type: history-graph
            hours_to_show: 6
            entities:
              - entity: group.lights_b
                name: Light
              - entity: binary_sensor.0x00158d0002a14c5e_contact
                name: Door
              - entity: binary_sensor.presence_b
                name: Presence
              - entity: binary_sensor.esp32_node_b_radar
                name: Radar
              - entity: binary_sensor.wasp_b
                name: Wasp
              - entity: binary_sensor.d44867b64355_occupancy
                name: BLE
          - type: entities
            entities:
              - binary_sensor.presence_b
              - entity: timer.main_light_b
                name: timer light b
              - entity: timer.door_b
                name: timer door b
          - type: history-graph
            hours_to_show: 1
            entities:
              - entity: group.lights_t
                name: Light
              - entity: binary_sensor.0x00158d0001ef2ffc_contact
                name: Door T
              - entity: binary_sensor.presence_t
                name: Presence
              - entity: binary_sensor.d1mini_distance_sensor_radar
                name: Radar
              - entity: binary_sensor.wasp_t
                name: Wasp
              - entity: binary_sensor.d44867b8945f_occupancy
                name: BLE
          - type: entities
            entities:
              - binary_sensor.presence_t
              - entity: timer.main_light_t
                name: timer light t
              - entity: timer.door_t
                name: timer door t
      - type: entities
        entities:
          - input_boolean.dima_business_trip
          - input_datetime.dima_return_date
      - type: vertical-stack
        cards:
          - type: history-graph
            #hours_to_show: 6
            entities:
              - sensor.ds1621plus_download_throughput
              - sensor.ds1621plus_upload_throughput
      - type: history-graph
        entities:
          - entity: sensor.blackhole_down_speed
            name: T
          - entity: sensor.qbittorrent_down_speed
            name:
              QB

              # - type: history-graph
          #   #hours_to_show: 6
          #   entities:
          #     - sensor.ds920plus_download_throughput
          #     - sensor.ds920plus_upload_throughput

      - type: vertical-stack
        cards:
          - type: history-graph
            hours_to_show: 8
            entities:
              - entity: binary_sensor.pova_6_interactive
                name: Screen
              - entity: binary_sensor.pova_6_keyguard_locked
                name: Lock
              - entity: binary_sensor.school_phone_while_lesson
                name: Alarm
              - entity: schedule.sasha_school_schedule
                name: Schedule
              - entity: sensor.pova_6_active_app
                name: App
          - type: entities
            entities:
              #- sensor.pova_5_last_used_app
              - binary_sensor.pova_6_interactive
              - binary_sensor.pova_6_keyguard_locked
              - binary_sensor.pova_6_device_locked
              - binary_sensor.school_phone_while_lesson
              - sensor.pova_6_active_app
      - type: history-graph
        hours_to_show: 24
        entities:
          - entity: sensor.dns1_round_trip_time_average
            name: DNS1
          - entity: sensor.dns8_round_trip_time_average
            name: DNS8
          - entity: sensor.dns9_round_trip_time_average
            name: DNS9
          - entity: sensor.dns9_2_round_trip_time_average
            name: DNS9_2
      # - type: entities
      #   entities:
      #     - entity: sensor.iphone_dima
      #       name: Dima
      #     - entity: sensor.phone_sasha
      #       name: Sasha
      #     - entity: sensor.iphone_sandra
      #       name: Sandra
      #     - entity: sensor.iphone12_sandra
      #       name: Sandra12
      #     - entity: sensor.phone_vova
      #       name: Vova
      #     - type: divider
      #     - entity: number.espresense_kitchen_max_distance
      #       name: Kitchen Max
      #     - entity: number.espresense_sasha_max_distance
      #       name: Sasha Max
      #     - entity: number.espresense_master_bedroom_max_distance
      #       name: MBedr Max
      #     - entity: number.espresense_vova_max_distance
      #       name: Vova Max
      #     - type: divider
      #     - entity: button.espresense_kitchen_restart
      #       name: Kitchen Restart
      #     - entity: button.espresense_sasha_restart
      #       name: Sasha Restart
      #     - entity: button.espresense_master_bedroom_restart
      #       name: MBedr Restart
      #     - entity: button.espresense_vova_restart
      #       name: Vova Restart
      - type: "custom:mini-graph-card"
        color_thresholds_transition: hard
        entities:
          - entity: sensor.energy_all_iot_single
            name: IoT
            color: darkorange
          - entity: sensor.energy_all_lights_single
            name: Lights
            color: royalblue
          - entity: sensor.energy_all_pc_single
            name: PC
            color: red
          - entity: sensor.energy_fridge_single
            name: Fridge
            color: green
          - entity: sensor.energy_kettle_single
            name: Kettle
            color: grey
          - entity: sensor.energy_washer_single
            name: Washer
            color: yellow
        #group: false
        group_by: hour
        hour24: true
        hours_to_show: 6
        points_per_hour: 30
        aggregate_func: delta
        show:
          extrema: true
          fill: fade
          icon: true
          labels: false
          name: true
          state: true
          graph: bar
        # state_map:
        #   - label: "Off"
        #     value: "off"
        #   - label: "On"
        #     value: "on"
        style: |
          ha-card {
            border: solid 2px var(--primary-color);
          }
      - type: custom:stack-in-card
        mode: vertical
        cards:
          - type: entities
            state_color: true
            entities:
              - input_text.text_to_tts
              - input_select.tts_audio_out
              - input_select.tts_audio_mode
              - input_select.tts_audio_effect
              - input_number.tts_volume
              - script.text_to_tts
              - entity: sensor.yandex_response
                name: Response
              - type: attribute
                name: Time fired
                entity: sensor.yandex_response
                attribute: time_fired
          - type: glance
            columns: 6
            state_color: true
            entities:
              - entity: sensor.yandex_v_alice_state
                name: V
              - entity: sensor.yandex_s_alice_state
                name: S
              - entity: sensor.yandex_k_alice_state
                name: K
              - entity: sensor.yandex_mb_alice_state
                name: MB
              - entity: sensor.yandex_hb_alice_state
                name: HB
              - entity: sensor.yandex_b_alice_state
                name: B

          - type: glance
            columns: 6
            state_color: true
            entities:
              - entity: sensor.yandex_v_alice_volume
                name: V
              - entity: sensor.yandex_s_alice_volume
                name: S
              - entity: sensor.yandex_k_alice_volume
                name: K
              - entity: sensor.yandex_mb_alice_volume
                name: MB
              - entity: sensor.yandex_hb_alice_volume
                name: HB
              - entity: sensor.yandex_b_alice_volume
                name: B

      - type: entities
        state_color: true
        entities:
          - binary_sensor.ble_gateway
          - input_boolean.settings_ble_gateway
          - input_boolean.settings_ble_gateway_discovery
          - input_text.settings_ble_gateway_add_device
      - type: glance
        columns: 4
        entities:
          - entity: binary_sensor.nut3_green_presence
            name: Green
          - entity: binary_sensor.nut3_pink_presence
            name: Pink
          - entity: binary_sensor.nut3_grey_presence
            name: Grey
          - entity: binary_sensor.nut3_white_presence
            name: White
      - type: custom:stack-in-card
        mode: vertical
        cards:
          - type: "custom:mini-graph-card"
            color_thresholds_transition: hard
            entities:
              - color: "#ff1000"
                entity: sensor.sonoff_mini_r4_kiosk_charger_battery_level
                name: Batt
                show_line: true
              - color: "rgba(0,255,100,1)"
                entity: switch.sonoff_mini_r4_kiosk_charger_relay
                show_line: false
                y_axis: secondary
            group: false
            #group_by: hour
            hour24: true
            hours_to_show: 48
            line_width: 2
            points_per_hour: 60
            show:
              extrema: true
              fill: fade
              icon: true
              labels: false
              name: true
              state: true
            state_map:
              - label: "Off"
                value: "off"
              - label: "On"
                value: "on"
            style: |
              ha-card {
                border: solid 2px var(--primary-color);
              }
          - type: entities
            state_color: true
            entities:
              - switch.sonoff_mini_r4_kiosk_charger_relay
              - switch.sonoff_mini_r4_kiosk_charger_always_on
              - binary_sensor.sonoff_mini_r4_kiosk_charger_auto_mode
              - sensor.sonoff_mini_r4_kiosk_charger_battery_level
              - sensor.sonoff_mini_r4_kiosk_charger_people
              - binary_sensor.sonoff_mini_r4_kiosk_charger_security
              - binary_sensor.sonoff_mini_r4_kiosk_charger_tod
              - number.sonoff_mini_r4_kiosk_charger_minlevel
              - number.sonoff_mini_r4_kiosk_charger_maxlevel

      - type: "custom:mini-graph-card"
        color_thresholds_transition: hard
        entities:
          - color: "#ff1000"
            entity: sensor.ble_temperature_ble_fridge
            name: T Fridge
            show_line: true
          - color: "#0010ff"
            entity: sensor.ble_temperature_ble_freezer
            name: T Freezer
            show_line: true
          - color: "rgba(0,255,100,1)"
            entity: binary_sensor.fridge_hb
            show_line: false
            y_axis: secondary
        group: false
        #group_by: hour
        hour24: true
        hours_to_show: 24
        line_width: 1
        points_per_hour: 60
        show:
          extrema: true
          fill: fade
          icon: true
          labels: false
          name: true
          state: true
        state_map:
          - label: "Off"
            value: "off"
          - label: "On"
            value: "on"
        style: |
          ha-card {
            border: solid 2px var(--primary-color);
          }

      - type: "custom:mini-graph-card"
        name: BLE Events
        entities:
          - entity: sensor.esp32_poe_ble_hs_events
            name: POE HS
            color: yellow
          - entity: sensor.esp32_poe_ble_mb_events
            name: POE MB
            color: red
          - entity: sensor.esp32_poe_ble_s_events
            name: POE S
            color: green
        #group: false
        group_by: hour
        hour24: true
        hours_to_show: 12
        points_per_hour: 30
        aggregate_func: max
        show:
          extrema: true
          fill: fade
          icon: true
          labels: false
          name: true
          state: true
          graph: bar

      - type: glance
        columns: 5
        entities:
          - entity: binary_sensor.round_led_k_prev
            name: K
          - entity: binary_sensor.round_led_mb_prev
            name: MB
          - entity: binary_sensor.round_led_hs_prev
            name: HS
          - entity: binary_sensor.square_led_s_prev
            name: S
          - entity: binary_sensor.square_led_v_prev
            name: V

      - type: custom:auto-entities
        card:
          show_header_toggle: false
          type: entities
          title: Battery
        filter:
          exclude:
            - state: ">30"
          include:
            - entity_id: "sensor.*_battery"
        sort:
          method: false
          numeric: true
          reverse: true

      - type: custom:auto-entities
        card:
          type: entities
          #title: Unavailables
          show_header_toggle: false
          state_color: true
        filter:
          include:
            - state: "unavailable"
        sort:
          method: false
          numeric: true
          reverse: true

      # - type: custom:stack-in-card
      #   mode: vertical
      #   cards:
      #     - type: glance
      #       entities:
      #         - entity: sensor.watchman_last_updated
      #           name: Updated
      #           tap_action:
      #             action: call-service
      #             service: watchman.report
      #             service_data:
      #               create_file: true
      #               send_notification: false
      #               service: notify.telegram
      #               data:
      #                 parse_mode: html
      #               parse_config: true
      #               chunk_size: true
      #         - entity: sensor.watchman_missing_entities
      #           name: Entities
      #         - entity: sensor.watchman_missing_services
      #           name: Services
      #     - type: markdown
      #       content: >-
      #         {%- for item in state_attr("sensor.watchman_missing_entities",
      #         "entities") %} <hr> <table><tr> <td> <ha-icon icon='mdi: {%- if
      #         item.state=="missing"-%}cloud-alert' {%- elif item.state=="unavail"
      #         -%}cloud-off-outline' {%- else-%}cloud-question' {%- endif -%} ></ha-icon> {{
      #         item.id }} [{{item.state}}] <a title="{{item.occurrences}}">
      #         {{item.occurrences.split('/')[-1].split(':')[0]}}</a> </td></tr></table> {%-
      #         endfor %}
      #       # title: Watchman report
      #       card_mod:
      #         style:
      #           ha-markdown:
      #             $: |
      #               ha-markdown-element:first-of-type hr{
      #                 border-color: #303030;
      #               }

      - type: custom:history-explorer-card
        recordedEntitiesOnly: true

  - title: Testing
    icon: mdi:poll
    cards:
      - type: custom:auto-entities
        card:
          show_header_toggle: false
          type: entities
          title: CPU
        filter:
          # exclude:
          #   - state: "unavailable"
          include:
            - entity_id: "sensor.*_cpu_percent"
        sort:
          method: entity_id

      - type: custom:auto-entities
        card:
          show_header_toggle: false
          type: entities
          title: Memory
        filter:
          # exclude:
          #   - state: "unavailable"
          include:
            - entity_id: "sensor.*_memory_percent"
        sort:
          method: entity_id

  # - title: Stats
  #   icon: mdi:ruler
  #   cards:
  #     - type: markdown
  #       title: Automations Triggered
  #       content: |
  #         |D|H|M||Time||Name|
  #         |---:|----:|----:|:--:|:---:|:--:|:----|
  #         {% for state in states.automation
  #           | selectattr('state', 'ne', 'unavailable')
  #           | selectattr('name', 'ne', 'system_esphome_ble_advert')
  #           | selectattr('name', 'ne', 'system_triggered_automations_counter')
  #           | selectattr('name', 'ne', 'system_executed_scripts')
  #           | selectattr('attributes.last_triggered', 'ne', None)
  #           |selectattr('attributes.last_triggered')
  #           |sort(attribute='attributes.last_triggered', reverse=true) if (now() - state.attributes.last_triggered).days < 1 -%}
  #           {%- set t1 = state.attributes.last_triggered.timestamp() | timestamp_custom('%H:%M') -%}
  #           {%- set t = now() - state.attributes.last_triggered -%}
  #           {%- set days = t.days if t.days > 0 else '&nbsp;' -%}
  #           {%- set hrs = t.seconds//3600 %}
  #           {%- set hrs = hrs if hrs > 0 else '&nbsp;' -%}
  #           |{{days}}|{{hrs}}|{{(t.seconds//60)%60}}||{{t1}}||{{state.name}}|
  #         {% endfor %}
  #     - type: markdown
  #       title: Last changed
  #       content: |
  #         |D|H|M||Time||Name|
  #         |---:|----:|----:|:--:|:---:|:--:|:----|
  #         {% for state in states
  #             |sort(attribute='last_changed', reverse=true) if (now() - state.last_changed).days < 1 -%}
  #           {%- set t1 = state.last_changed.timestamp() | timestamp_custom('%H:%M') -%}
  #           {%- set t = now() - state.last_changed -%}
  #           {%- set days = t.days if t.days > 0 else '&nbsp;' -%}
  #           {%- set hrs = t.seconds//3600 %}
  #           {%- set hrs = hrs if hrs > 0 else '&nbsp;' -%}
  #           |{{days}}|{{hrs}}|{{(t.seconds//60)%60}}||{{t1}}||{{state.entity_id}}|
  #         {% endfor %}
  # - type: markdown
  #   title: Entities
  #   content: >
  #     Total {{ states | count }}{{'\n'}}

  #     {%- for d in states | groupby('domain') %}
  #     <img src="https://brands.home-assistant.io/_/{{ d[0] }}/logo.png" height="20"></a>&nbsp;{{ d[0] }}&nbsp;{{ states[d[0]] | count }}{{'\n'}}
  #     {%- endfor %}

  # - title: Calendat
  #   icon:  mdi:calendar
  #   panel: true
  #   cards:
  #     - type: calendar
  #       entities:
  #         - calendar.dni_rozhdeniia
  #         - calendar.prazdniki_rossii_polnyi

  # - title: Diagnostics
  #   icon: mdi:card-text-outline
  #   panel: true
  #   cards:
  #     - type: markdown
  #       content: |
  #         [diagnostics](/config/integrations/integration/hass_diagnostics) | [log](/config/logs) | total: {{ states('sensor.smart_log') }} items

  #         {% for i in state_attr('sensor.smart_log', 'records') -%}
  #         ---
  #         <details>
  #         <summary>
  #           <b>{{i.get('domain') or i.get('package') or i.name}}</b> ({{i.count}}) {{i.get('category','')}} {{i.get('host','')}}
  #           <br>&nbsp; &nbsp;<i>{{i.short}}</i>
  #         </summary>
  #         <div><b>{{i.name}}</b></div>
  #         <div>{{i.message|replace('\n',' ')|regex_replace('(http[^\s]+)', '<a href="\\1">\\1</a>')}}</div>
  #         <div>{{i.source|join(', ')}}{{', <a href="%s">github</a>'%i.github if 'github' in i}}</div>
  #         {{'<pre>'+i.exception+'</pre>' if 'exception' in i}}
  #         </details>

  #         {% endfor %}
